{"version":3,"sources":["file:///Users/edz/work/creatorproject/3.3.1/test/assets/test/src/common/base/ui/ScrollList.ts"],"names":["_decorator","CCBoolean","CCFloat","CCInteger","Component","Enum","EventHandler","instantiate","isValid","Layers","Layout","Node","NodePool","Prefab","ScrollView","Size","tween","UITransform","Vec3","Widget","DEV","EDITOR","ScrollListItem","ccclass","property","disallowMultiple","menu","executionOrder","requireComponent","TemplateType","LayerType","SlideType","SelectedType","ScrollList","type","tooltip","visible","templateType","NODE","PREFAB","range","slide","_slideMode","PAGE","val","slideMode","NORMAL","cyclic","virtual","lackCenter","lackSlide","selectedMode","NONE","SINGLE","repeatEventSingle","serializable","_virtual","_numItems","_onScrolling","updateRate","_updateRate","selectedId","_selectedId","t","item","getItemByListId","listItem","_lastSelectedId","getComponent","selected","canTouchCancel","lastItem","selectedEvent","emitEvents","_actualNumItems","MULT","bool","sub","multSelected","indexOf","push","splice","numItems","checkInited","_forceUpdate","_resizeContent","_cyclicNum","frameByFrameRenderNum","curPageNum","nearestListId","layout","content","enabled","_delRedundantItem","firstListId","len","n","_createOrUpdateItem2","_updateCounter","_updateDone","displayItemNum","scrollView","_scrollView","onLoad","_init","onDestroy","_itemTmp","destroy","tmpNode","_mainPool","clear","_poolList","forEach","value","onEnable","_registerEvent","_aniDelRuning","_aniDelItem","_aniDelBeforePos","position","_aniDelBeforeScale","scale","_aniDelCB","onDisable","_unregisterEvent","node","on","EventType","TOUCH_START","_onTouchStart","_onTouchUp","TOUCH_CANCEL","_onTouchCancelled","_onScrollBegan","_onScrollEnded","SIZE_CHANGED","_onSizeChanged","off","_inited","_thisNodeUt","_contentUt","console","error","name","_layout","_align","_resizeMode","resizeMode","_startAxis","startAxis","_topGap","paddingTop","_rightGap","paddingRight","_bottomGap","paddingBottom","_leftGap","paddingLeft","_columnGap","spacingX","_lineGap","spacingY","_colLineNum","_verticalDir","verticalDirection","_horizontalDir","horizontalDirection","setTemplateItem","tmpPrefab","ADHERING","inertia","_onMouseWheel","_lastDisplayData","displayData","_processAutoScrolling","bind","_startBounceBackIfNeeded","Type","HORIZONTAL","HorizontalDirection","LEFT_TO_RIGHT","_alignCalcType","RIGHT_TO_LEFT","VERTICAL","VerticalDirection","TOP_TO_BOTTOM","BOTTOM_TO_TOP","GRID","AxisDirection","removeAllChildren","contentLayerType","SLICE","i","layerNodeList","length","childContent","layer","UI_2D","contentTF","childtf","addComponent","anchorX","anchorY","parent","_contentList","dt","OUT_OF_BOUNDARY_BREAKING_FACTOR","EPSILON","ZERO","quintEaseOut","time","sv","isAutoScrollBrake","brakingFactor","percentage","Math","min","clonedAutoScrollTargetDelta","clone","multiplyScalar","clonedAutoScrollStartPosition","add","reachedEnd","abs","fireEvent","SCROLL_ENG_WITH_THRESHOLD","brakeOffsetPosition","subtract","set","moveDelta","outOfBoundary","equals","deltaMove","SCROLLING","SCROLL_ENDED","_itemTmpUt","ResizeMode","CHILDREN","_itemSize","cellSize","itemUt","width","height","com","remove","_needUpdateWidget","_sizeType","trimW","floor","trimH","printLog","result","_customSize","fixed","_getFixedSize","count","lineNum","ceil","colNum","_allItemSize","_allItemSizeNoEdge","totalSize","_cyclicPos1","spacing","_cyclicPos2","_cyclicAllItemSize","_cycilcAllItemSizeNoEdge","_lack","slideOffset","targetWH","ev","undefined","frameCount","scrollPos","getPosition","y","x","addVal","contentPos","z","setPosition","isAutoScrolling","_calcViewPos","vTop","vRight","vBottom","vLeft","viewTop","viewBottom","viewRight","viewLeft","itemPos","curId","endId","breakFor","_calcItemPos","right","left","bottom","top","ww","hh","id","haveDataChange","sort","a","b","_doneAfterUpdate","c","_createOrUpdateItem","_showAnimation","_calcNearestItem","elasticLeft","elasticRight","elasticTop","elasticBottom","itemX","itemY","cs","offset","colLine","_calcExistItemPos","ut","pos","data","getItemPos","listId","parseInt","_beganPos","_curScrollIsTouch","scrollToListId","to","start","adhering","adhere","_pageAdhere","captureListeners","isMe","eventPhase","Event","AT_TARGET","target","itemNode","_listId","_scrollItem","_scrollPos","_adheringBarrier","simulate","_onItemAdaptive","updateAll","_scrollToListId","unschedule","_scrollToSo","scrollTo","max","_scrollToEndTime","Date","getTime","curPos","dis","pageDistance","canSkip","timeInSecond","prePage","nextPage","update","animate","elementList","canGet","size","get","pool","index","element","component","posV3","setContentSize","vec3Point","_resetItemSize","addChild","widget","updateAlignment","setSiblingIndex","children","list","renderEvent","_updateListItem","animationEvent","_updateItemPos","listIdOrItem","isNaN","setMultSelected","args","Array","isArray","getMultSelected","hasMultSelected","updateItem","_getOutsideItem","find","d","arr","isCached","put","m","_delSingleItem","removeFromParent","aniDelItem","callFunc","aniType","warn","curLastId","resetSelectedId","showAni","newId","newData","newCustomSize","idNumber","sec","twe","haveCB","posData","call","overStress","updateLayout","targetX","targetY","viewPos","comparePos","runScroll","scrollToOffset","scheduleOnce","center","skipPage","pageNum","pageChangeEvent","calcCustomSize","temp","Object","keys"],"mappings":"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","sourcesContent":["/******************************************\n * @author kL <klk0@qq.com>\n * @date 2020/12/9\n * @doc 列表组件.\n * @end\n ******************************************/\n\"use strict\";\nconst { ccclass, property, disallowMultiple, menu, executionOrder, requireComponent } = _decorator;\nimport { _decorator, CCBoolean, CCFloat, CCInteger, Component, Enum, EventHandler, instantiate, isValid, Layers, Layout, Node, NodePool, Prefab, ScrollView, Size, tween, Tween, UITransform, Vec2, Vec3, Widget } from \"cc\";\nimport { DEV, EDITOR } from \"cc/env\";\nimport ScrollListItem from \"./ScrollListItem\";\n\nenum TemplateType {\n\tNODE = 1,\n\tPREFAB = 2,\n}\n\nenum LayerType {\n\t/** 不分层 */\n\tNONE,\n\t/** 分层 */\n\tSLICE,\n}\n\nenum SlideType {\n\tNORMAL = 1, //普通\n\tADHERING = 2, //粘附模式，将强制关闭滚动惯性\n\tPAGE = 3, //页面模式，将强制关闭滚动惯性\n}\n\nenum SelectedType {\n\tNONE = 0,\n\tSINGLE = 1, //单选\n\tMULT = 2, //多选\n}\n\n@ccclass\n@disallowMultiple()\n@menu(\"组件库/ScrollList\")\n@requireComponent(ScrollView)\n//脚本生命周期回调的执行优先级。小于 0 的脚本将优先执行，大于 0 的脚本将最后执行。该优先级只对 onLoad, onEnable, start, update 和 lateUpdate 有效，对 onDisable 和 onDestroy 无效。\n@executionOrder(-5000)\nexport default class ScrollList extends Component {\n\t@property({ type: Enum(LayerType), tooltip: \"是否分层渲染\" })\n\tpublic contentLayerType: LayerType = LayerType.NONE;\n\t//模板Item（Node）\n\t@property({\n\t\ttype: Node,\n\t\ttooltip: DEV && \"模板Item\",\n\t\tvisible() {\n\t\t\treturn this.templateType == TemplateType.NODE;\n\t\t},\n\t})\n\ttmpNode: Node = null!;\n\t//模板Item（Prefab）\n\t@property({\n\t\ttype: Prefab,\n\t\ttooltip: DEV && \"模板Item\",\n\t\tvisible() {\n\t\t\treturn this.templateType == TemplateType.PREFAB;\n\t\t},\n\t})\n\ttmpPrefab: Prefab = null!;\n\t//翻页作用距离\n\t@property({\n\t\ttype: CCFloat,\n\t\trange: [0, 1, 0.1],\n\t\ttooltip: DEV && \"翻页作用距离\",\n\t\tslide: true,\n\t\tvisible() {\n\t\t\treturn this._slideMode == SlideType.PAGE;\n\t\t},\n\t})\n\tpublic pageDistance: number = 0.3;\n\t//是否为循环列表\n\t@property({\n\t\ttooltip: DEV && \"是否为循环列表\",\n\t\tvisible() {\n\t\t\tlet val: boolean = /*this.virtual &&*/ this.slideMode == SlideType.NORMAL;\n\t\t\tif (!val) this.cyclic = false;\n\t\t\treturn val;\n\t\t},\n\t})\n\tpublic cyclic: boolean = false;\n\t//缺省居中\n\t@property({\n\t\ttooltip: DEV && \"Item数量不足以填满Content时，是否居中显示Item（不支持Grid布局）\",\n\t\tvisible() {\n\t\t\treturn this.virtual;\n\t\t},\n\t})\n\tpublic lackCenter: boolean = false;\n\t//缺省可滑动\n\t@property({\n\t\ttooltip: DEV && \"Item数量不足以填满Content时，是否可滑动\",\n\t\tvisible() {\n\t\t\tlet val: boolean = this.virtual && !this.lackCenter;\n\t\t\tif (!val) this.lackSlide = false;\n\t\t\treturn val;\n\t\t},\n\t})\n\tpublic lackSlide: boolean = false;\n\t//分帧渲染（每帧渲染的Item数量（<=0时关闭分帧渲染））\n\t@property({\n\t\ttype: CCInteger,\n\t\trange: [0, 12, 1],\n\t\ttooltip: DEV && \"逐帧渲染时，每帧渲染的Item数量（<=0时关闭分帧渲染）\",\n\t\tslide: true,\n\t})\n\tpublic frameByFrameRenderNum: number = 0;\n\t//渲染事件（渲染器）\n\t@property({\n\t\ttype: EventHandler,\n\t\ttooltip: DEV && \"渲染事件（渲染器）\",\n\t})\n\tpublic renderEvent: EventHandler = new EventHandler();\n\t//选择模式\n\t@property({\n\t\ttype: Enum(SelectedType),\n\t\ttooltip: DEV && \"选择模式\",\n\t})\n\tpublic selectedMode: SelectedType = SelectedType.NONE;\n\t//触发选择事件\n\t@property({\n\t\ttype: EventHandler,\n\t\ttooltip: DEV && \"触发选择事件\",\n\t\tvisible() {\n\t\t\treturn this.selectedMode > SelectedType.NONE;\n\t\t},\n\t})\n\tpublic selectedEvent: EventHandler = new EventHandler();\n\t@property({\n\t\ttooltip: DEV && \"是否重复响应单选事件\",\n\t\tvisible() {\n\t\t\treturn this.selectedMode == SelectedType.SINGLE;\n\t\t},\n\t})\n\tpublic repeatEventSingle: boolean = false;\n\tpublic content: Node;\n\tpublic displayItemNum: number;\n\tpublic _actualNumItems: number;\n\tpublic displayData: any[];\n\tpublic _customSize: any;\n\tpublic curPageNum: number = 0;\n\t@property({\n\t\ttype: false,\n\t\ttooltip: \"TOGGLE 模式下  选中后再次点击取消选中（需要 repeatEventSingle 为 'true'）\",\n\t\tvisible: function (this: ScrollList) {\n\t\t\treturn this.selectedMode === SelectedType.SINGLE && this.repeatEventSingle === true;\n\t\t},\n\t})\n\tprivate canTouchCancel: boolean = false;\n\n\t//模板类型\n\t@property({ type: Enum(TemplateType), tooltip: DEV && \"模板类型\" })\n\tprivate templateType: TemplateType = TemplateType.NODE;\n\t//页面改变事件\n\t@property({\n\t\ttype: EventHandler,\n\t\ttooltip: DEV && \"页面改变事件\",\n\t\tvisible() {\n\t\t\treturn this._slideMode == SlideType.PAGE;\n\t\t},\n\t})\n\tprivate pageChangeEvent: EventHandler = new EventHandler();\n\n\t//初始化动画事件\n\t@property({\n\t\ttype: EventHandler,\n\t\ttooltip: DEV && \"初始化动画事件\",\n\t})\n\tpublic animationEvent: EventHandler = new EventHandler();\n\tprivate _lastSelectedId: number;\n\tprivate multSelected: number[];\n\tprivate _forceUpdate: boolean = false;\n\tprivate _align: number;\n\tprivate _horizontalDir: number;\n\tprivate _verticalDir: number;\n\tprivate _startAxis: number;\n\tprivate _alignCalcType: number;\n\tprivate _contentUt: UITransform;\n\tprivate firstListId: number;\n\tprivate _updateDone: boolean = true;\n\tprivate _updateCounter: number;\n\tprivate _cyclicNum: number;\n\tprivate _cyclicPos1: number;\n\tprivate _cyclicPos2: number;\n\tprivate _inited: boolean = false;\n\tprivate _layout: Layout;\n\tprivate _resizeMode: number;\n\tprivate _topGap: number;\n\tprivate _rightGap: number;\n\tprivate _bottomGap: number;\n\tprivate _leftGap: number;\n\tprivate _columnGap: number;\n\tprivate _lineGap: number;\n\tprivate _colLineNum: number;\n\tprivate _lastDisplayData: number[];\n\tprivate _mainPool: NodePool = null!;\n\tprivate _poolList: NodePool[] = [];\n\tprivate _itemTmp: any;\n\tprivate _itemTmpUt: UITransform;\n\tprivate _needUpdateWidget: boolean = false;\n\tprivate _itemSize: Size;\n\tprivate _sizeType: boolean;\n\tprivate frameCount: number;\n\tprivate _aniDelRuning: boolean = false;\n\tprivate _aniDelCB: Function;\n\tprivate _aniDelItem: any;\n\tprivate _aniDelBeforePos: Vec2;\n\tprivate _aniDelBeforeScale: number;\n\tprivate viewTop: number;\n\tprivate viewRight: number;\n\tprivate viewBottom: number;\n\tprivate viewLeft: number;\n\tprivate _doneAfterUpdate: boolean = false;\n\tprivate elasticTop: number;\n\tprivate elasticRight: number;\n\tprivate elasticBottom: number;\n\tprivate elasticLeft: number;\n\tprivate scrollToListId: number;\n\tprivate adhering: boolean = false;\n\tprivate _adheringBarrier: boolean = false;\n\tprivate nearestListId: number;\n\tprivate _beganPos: number;\n\tprivate _scrollPos: number;\n\tprivate _curScrollIsTouch: boolean; //当前滑动是否为手动\n\tprivate _scrollToListId: number;\n\tprivate _scrollToEndTime: number;\n\tprivate _scrollToSo: any;\n\tprivate _lack: boolean;\n\tprivate _allItemSize: number;\n\tprivate _allItemSizeNoEdge: number;\n\tprivate _scrollItem: any; //当前控制 ScrollView 滚动的 Item\n\tprivate _thisNodeUt: UITransform;\n\t/*分层子节点数组*/\n\tprivate _contentList: Node[] = [];\n\n\tprivate _showAnimation: boolean = true;\n\n\t//滑动模式\n\t@property({})\n\tprivate _slideMode: SlideType = SlideType.NORMAL;\n\n\tget slideMode() {\n\t\treturn this._slideMode;\n\t}\n\n\t@property({\n\t\ttype: Enum(SlideType),\n\t\ttooltip: DEV && \"滑动模式\",\n\t})\n\tset slideMode(val: SlideType) {\n\t\tthis._slideMode = val;\n\t}\n\n\t//是否为虚拟列表（动态列表）\n\t@property({})\n\tprivate _virtual: boolean = true;\n\n\tget virtual() {\n\t\treturn this._virtual;\n\t}\n\n\t@property({\n\t\ttype: CCBoolean,\n\t\ttooltip: DEV && \"是否为虚拟列表（动态列表）\",\n\t})\n\tset virtual(val: boolean) {\n\t\tif (val !== false) this._virtual = val;\n\t\tif (!DEV && this._numItems != 0) {\n\t\t\tthis._onScrolling();\n\t\t}\n\t}\n\n\t//刷新频率\n\t@property({ type: CCInteger })\n\tprivate _updateRate: number = 0;\n\n\tget updateRate() {\n\t\treturn this._updateRate;\n\t}\n\n\t@property({\n\t\ttype: CCInteger,\n\t\trange: [0, 6, 1],\n\t\ttooltip: DEV && \"刷新频率（值越大刷新频率越低、性能越高）\",\n\t\tslide: true,\n\t})\n\tset updateRate(val: number) {\n\t\tif (val >= 0 && val <= 6) {\n\t\t\tthis._updateRate = val;\n\t\t}\n\t}\n\n\t//当前选择id\n\tprivate _selectedId: number = -1;\n\n\tget selectedId() {\n\t\treturn this._selectedId;\n\t}\n\n\tset selectedId(val: number) {\n\t\tlet t: any = this;\n\t\tlet item: any;\n\t\tswitch (t.selectedMode) {\n\t\t\tcase SelectedType.SINGLE: {\n\t\t\t\tif (!t.repeatEventSingle && val == t._selectedId) return;\n\t\t\t\titem = t.getItemByListId(val);\n\t\t\t\t// if (!item && val >= 0)\n\t\t\t\t//     return;\n\t\t\t\tlet listItem: ScrollListItem;\n\t\t\t\tif (t._selectedId >= 0) t._lastSelectedId = t._selectedId;\n\t\t\t\t//如果＜0则取消选择，把_lastSelectedId也置空吧，如果以后有特殊需求再改吧。\n\t\t\t\telse t._lastSelectedId = 0;\n\t\t\t\tt._selectedId = val;\n\t\t\t\tif (item) {\n\t\t\t\t\tlistItem = item.getComponent(ScrollListItem);\n\t\t\t\t\tlistItem.selected = true;\n\t\t\t\t}\n\t\t\t\tif (t._lastSelectedId >= 0 && (t._lastSelectedId != t._selectedId || (t._lastSelectedId === t._selectedId && this.canTouchCancel))) {\n\t\t\t\t\tlet lastItem: any = t.getItemByListId(t._lastSelectedId);\n\t\t\t\t\tif (lastItem) {\n\t\t\t\t\t\tlastItem.getComponent(ScrollListItem).selected = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (t._lastSelectedId === t._selectedId && this.canTouchCancel) {\n\t\t\t\t\t\tt._selectedId = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t.selectedEvent) {\n\t\t\t\t\tEventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId === 0 ? 0 : t._lastSelectedId % this._actualNumItems);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase SelectedType.MULT: {\n\t\t\t\titem = t.getItemByListId(val);\n\t\t\t\tif (!item) return;\n\t\t\t\tlet listItem = item.getComponent(ScrollListItem);\n\t\t\t\tif (t._selectedId >= 0) t._lastSelectedId = t._selectedId;\n\t\t\t\tt._selectedId = val;\n\t\t\t\tlet bool: boolean = !listItem.selected;\n\t\t\t\tlistItem.selected = bool;\n\t\t\t\tlet sub: number = t.multSelected.indexOf(val);\n\t\t\t\tif (bool && sub < 0) {\n\t\t\t\t\tt.multSelected.push(val);\n\t\t\t\t} else if (!bool && sub >= 0) {\n\t\t\t\t\tt.multSelected.splice(sub, 1);\n\t\t\t\t}\n\t\t\t\tif (t.selectedEvent) {\n\t\t\t\t\tEventHandler.emitEvents([t.selectedEvent], item, val % this._actualNumItems, t._lastSelectedId === 0 ? 0 : t._lastSelectedId % this._actualNumItems, bool);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t//列表数量\n\t@property({\n\t\tserializable: false,\n\t})\n\tprivate _numItems: number = 0;\n\n\tget numItems() {\n\t\treturn this._actualNumItems;\n\t}\n\n\tset numItems(val: number) {\n\t\tlet t = this;\n\t\tif (!t.checkInited(false)) return;\n\t\tif (val === 0 || val < 0) {\n\t\t\t// console.error(\"numItems set the wrong::\", val);\n\t\t\treturn;\n\t\t}\n\t\tt._actualNumItems = t._numItems = val;\n\t\tt._forceUpdate = true;\n\n\t\tif (t._virtual) {\n\t\t\tt._resizeContent();\n\t\t\tif (t.cyclic) {\n\t\t\t\tt._numItems = t._cyclicNum * t._numItems;\n\t\t\t}\n\t\t\tt._onScrolling();\n\t\t\tif (!t.frameByFrameRenderNum && t.slideMode == SlideType.PAGE) t.curPageNum = t.nearestListId;\n\t\t} else {\n\t\t\tif (t.cyclic) {\n\t\t\t\tt._resizeContent();\n\t\t\t\tt._numItems = t._cyclicNum * t._numItems;\n\t\t\t}\n\t\t\tlet layout: Layout = t.content.getComponent(Layout);\n\t\t\tif (layout) {\n\t\t\t\tlayout.enabled = true;\n\t\t\t}\n\t\t\tt._delRedundantItem();\n\n\t\t\tt.firstListId = 0;\n\t\t\tif (t.frameByFrameRenderNum > 0) {\n\t\t\t\t//先渲染几个出来\n\t\t\t\tlet len: number = t.frameByFrameRenderNum > t._numItems ? t._numItems : t.frameByFrameRenderNum;\n\t\t\t\tfor (let n: number = 0; n < len; n++) {\n\t\t\t\t\tt._createOrUpdateItem2(n);\n\t\t\t\t}\n\t\t\t\tif (t.frameByFrameRenderNum < t._numItems) {\n\t\t\t\t\tt._updateCounter = t.frameByFrameRenderNum;\n\t\t\t\t\tt._updateDone = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (let n: number = 0; n < t._numItems; n++) {\n\t\t\t\t\tt._createOrUpdateItem2(n);\n\t\t\t\t}\n\t\t\t\tt.displayItemNum = t._numItems;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _scrollView: ScrollView;\n\n\tget scrollView() {\n\t\treturn this._scrollView;\n\t}\n\n\t//----------------------------------------------------------------------------\n\n\tonLoad() {\n\t\tthis._init();\n\t}\n\n\tonDestroy() {\n\t\tlet t: any = this;\n\t\tif (isValid(t._itemTmp)) t._itemTmp.destroy();\n\t\tif (isValid(t.tmpNode)) t.tmpNode.destroy();\n\n\t\tt._mainPool.clear();\n\t\tt._poolList.forEach((value) => {\n\t\t\tvalue.clear();\n\t\t});\n\t}\n\n\tonEnable() {\n\t\t// if (!EDITOR)\n\t\tthis._registerEvent();\n\t\tthis._init();\n\t\t// 处理重新显示后，有可能上一次的动画移除还未播放完毕，导致动画卡住的问题\n\t\tif (this._aniDelRuning) {\n\t\t\tthis._aniDelRuning = false;\n\t\t\tif (this._aniDelItem) {\n\t\t\t\tif (this._aniDelBeforePos) {\n\t\t\t\t\tthis._aniDelItem.position = this._aniDelBeforePos;\n\t\t\t\t\tdelete this._aniDelBeforePos;\n\t\t\t\t}\n\t\t\t\tif (this._aniDelBeforeScale) {\n\t\t\t\t\tthis._aniDelItem.scale = this._aniDelBeforeScale;\n\t\t\t\t\tdelete this._aniDelBeforeScale;\n\t\t\t\t}\n\t\t\t\tdelete this._aniDelItem;\n\t\t\t}\n\t\t\tif (this._aniDelCB) {\n\t\t\t\tthis._aniDelCB();\n\t\t\t\tdelete this._aniDelCB;\n\t\t\t}\n\t\t}\n\t}\n\n\tonDisable() {\n\t\t// if (!EDITOR)\n\t\tthis._unregisterEvent();\n\t}\n\n\t//注册事件\n\t_registerEvent() {\n\t\tlet t: any = this;\n\t\tt.node.on(Node.EventType.TOUCH_START, t._onTouchStart, t, true);\n\t\tt.node.on(\"touch-up\", t._onTouchUp, t);\n\t\tt.node.on(Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\n\t\tt.node.on(\"scroll-began\", t._onScrollBegan, t, true);\n\t\tt.node.on(\"scroll-ended\", t._onScrollEnded, t, true);\n\t\tt.node.on(\"scrolling\", t._onScrolling, t, true);\n\t\tt.node.on(Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\n\t}\n\n\t//卸载事件\n\t_unregisterEvent() {\n\t\tlet t: any = this;\n\t\tt.node.off(Node.EventType.TOUCH_START, t._onTouchStart, t, true);\n\t\tt.node.off(\"touch-up\", t._onTouchUp, t);\n\t\tt.node.off(Node.EventType.TOUCH_CANCEL, t._onTouchCancelled, t, true);\n\t\tt.node.off(\"scroll-began\", t._onScrollBegan, t, true);\n\t\tt.node.off(\"scroll-ended\", t._onScrollEnded, t, true);\n\t\tt.node.off(\"scrolling\", t._onScrolling, t, true);\n\t\tt.node.off(Node.EventType.SIZE_CHANGED, t._onSizeChanged, t);\n\t}\n\n\t//初始化各种..\n\t_init() {\n\t\tlet t: any = this;\n\t\tif (t._inited) return;\n\n\t\tt._thisNodeUt = t.node.getComponent(UITransform);\n\t\tt._scrollView = t.node.getComponent(ScrollView);\n\n\t\tt.content = t._scrollView.content;\n\t\tt._contentUt = t.content.getComponent(UITransform);\n\t\tif (!t.content) {\n\t\t\tconsole.error(t.node.name + \"'s ScrollView unset content!\");\n\t\t\treturn;\n\t\t}\n\n\t\tt._layout = t.content.getComponent(Layout);\n\n\t\tt._align = t._layout.type; //排列模式\n\t\tt._resizeMode = t._layout.resizeMode; //自适应模式\n\t\tt._startAxis = t._layout.startAxis;\n\n\t\tt._topGap = t._layout.paddingTop; //顶边距\n\t\tt._rightGap = t._layout.paddingRight; //右边距\n\t\tt._bottomGap = t._layout.paddingBottom; //底边距\n\t\tt._leftGap = t._layout.paddingLeft; //左边距\n\n\t\tt._columnGap = t._layout.spacingX; //列距\n\t\tt._lineGap = t._layout.spacingY; //行距\n\n\t\tt._colLineNum; //列数或行数（非GRID模式则=1，表示单列或单行）;\n\n\t\tt._verticalDir = t._layout.verticalDirection; //垂直排列子节点的方向\n\t\tt._horizontalDir = t._layout.horizontalDirection; //水平排列子节点的方向\n\n\t\tt.setTemplateItem(instantiate(t.templateType == TemplateType.PREFAB ? t.tmpPrefab : t.tmpNode));\n\n\t\t// 特定的滑动模式处理\n\t\tif (t._slideMode == SlideType.ADHERING || t._slideMode == SlideType.PAGE) {\n\t\t\tt._scrollView.inertia = false;\n\t\t\tt._scrollView._onMouseWheel = function () {\n\t\t\t\treturn;\n\t\t\t};\n\t\t}\n\t\tif (!t.virtual)\n\t\t\t// lackCenter 仅支持 Virtual 模式\n\t\t\tt.lackCenter = false;\n\n\t\tt._lastDisplayData = []; //最后一次刷新的数据\n\t\tt.displayData = []; //当前数据\n\n\t\tt._forceUpdate = false; //是否强制更新\n\t\tt._updateCounter = 0; //当前分帧渲染帧数\n\t\tt._updateDone = true; //分帧渲染是否完成\n\n\t\tt.curPageNum = 0; //当前页数\n\n\t\tif (t.cyclic || 0) {\n\t\t\tt._scrollView._processAutoScrolling = this._processAutoScrolling.bind(t);\n\t\t\tt._scrollView._startBounceBackIfNeeded = function () {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}\n\n\t\tswitch (t._align) {\n\t\t\tcase Layout.Type.HORIZONTAL: {\n\t\t\t\tswitch (t._horizontalDir) {\n\t\t\t\t\tcase Layout.HorizontalDirection.LEFT_TO_RIGHT:\n\t\t\t\t\t\tt._alignCalcType = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Layout.HorizontalDirection.RIGHT_TO_LEFT:\n\t\t\t\t\t\tt._alignCalcType = 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase Layout.Type.VERTICAL: {\n\t\t\t\tswitch (t._verticalDir) {\n\t\t\t\t\tcase Layout.VerticalDirection.TOP_TO_BOTTOM:\n\t\t\t\t\t\tt._alignCalcType = 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Layout.VerticalDirection.BOTTOM_TO_TOP:\n\t\t\t\t\t\tt._alignCalcType = 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase Layout.Type.GRID: {\n\t\t\t\tswitch (t._startAxis) {\n\t\t\t\t\tcase Layout.AxisDirection.HORIZONTAL:\n\t\t\t\t\t\tswitch (t._verticalDir) {\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.TOP_TO_BOTTOM:\n\t\t\t\t\t\t\t\tt._alignCalcType = 3;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.BOTTOM_TO_TOP:\n\t\t\t\t\t\t\t\tt._alignCalcType = 4;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Layout.AxisDirection.VERTICAL:\n\t\t\t\t\t\tswitch (t._horizontalDir) {\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.LEFT_TO_RIGHT:\n\t\t\t\t\t\t\t\tt._alignCalcType = 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.RIGHT_TO_LEFT:\n\t\t\t\t\t\t\t\tt._alignCalcType = 2;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// 清空 content\n\t\t// t.content.children.forEach((child: Node) => {\n\t\t//     child.removeFromParent();\n\t\t//     if (child != t.tmpNode && child.isValid)\n\t\t//         child.destroy();\n\t\t// });\n\t\tt.content.removeAllChildren();\n\t\tt._inited = true;\n\t\t//初始化 分层\n\t\tt._mainPool = new NodePool();\n\t\tconst tmpNode = t.templateType === TemplateType.PREFAB ? instantiate(t.tmpPrefab) : t.tmpNode;\n\n\t\tif (!EDITOR && isValid(tmpNode)) {\n\t\t\tlet listItem = tmpNode.getComponent(ScrollListItem);\n\t\t\tthis.contentLayerType = listItem.contentLayerType;\n\t\t\tif (this.contentLayerType === LayerType.SLICE) {\n\t\t\t\tfor (let i = 0; i < listItem.layerNodeList.length; i++) {\n\t\t\t\t\tlet childContent = new Node();\n\t\t\t\t\tchildContent.layer = Layers.Enum.UI_2D;\n\t\t\t\t\tconst contentTF = this.content.getComponent(UITransform);\n\t\t\t\t\tconst childtf = childContent.addComponent(UITransform);\n\t\t\t\t\tchildtf.anchorX = contentTF.anchorX;\n\t\t\t\t\tchildtf.anchorY = contentTF.anchorY;\n\t\t\t\t\tchildContent.position = this.content.position;\n\t\t\t\t\tchildContent.parent = this.content.parent;\n\t\t\t\t\tt._poolList.push(new NodePool()); //这是个池子..\n\t\t\t\t\tt._contentList.push(childContent); //分层节点数组\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 为了实现循环列表，必须覆写cc.ScrollView的某些函数\n\t * @param {Number} dt\n\t */\n\t_processAutoScrolling(dt: number) {\n\t\t// ------------- scroll-view 里定义的一些常量 -------------\n\t\tconst OUT_OF_BOUNDARY_BREAKING_FACTOR = 0.05;\n\t\tconst EPSILON = 1e-4;\n\t\tconst ZERO = new Vec3();\n\t\tconst quintEaseOut = (time: number) => {\n\t\t\ttime -= 1;\n\t\t\treturn time * time * time * time * time + 1;\n\t\t};\n\t\t// ------------- scroll-view 里定义的一些常量 -------------\n\n\t\tlet sv: ScrollView = this._scrollView;\n\n\t\tconst isAutoScrollBrake = sv[\"_isNecessaryAutoScrollBrake\"]();\n\t\tconst brakingFactor = isAutoScrollBrake ? OUT_OF_BOUNDARY_BREAKING_FACTOR : 1;\n\t\tsv[\"_autoScrollAccumulatedTime\"] += dt * (1 / brakingFactor);\n\n\t\tlet percentage = Math.min(1, sv[\"_autoScrollAccumulatedTime\"] / sv[\"_autoScrollTotalTime\"]);\n\t\tif (sv[\"_autoScrollAttenuate\"]) {\n\t\t\tpercentage = quintEaseOut(percentage);\n\t\t}\n\n\t\tconst clonedAutoScrollTargetDelta = sv[\"_autoScrollTargetDelta\"].clone();\n\t\tclonedAutoScrollTargetDelta.multiplyScalar(percentage);\n\t\tconst clonedAutoScrollStartPosition = sv[\"_autoScrollStartPosition\"].clone();\n\t\tclonedAutoScrollStartPosition.add(clonedAutoScrollTargetDelta);\n\t\tlet reachedEnd = Math.abs(percentage - 1) <= EPSILON;\n\n\t\tconst fireEvent = Math.abs(percentage - 1) <= sv[\"getScrollEndedEventTiming\"]();\n\t\tif (fireEvent && !sv[\"_isScrollEndedWithThresholdEventFired\"]) {\n\t\t\tsv[\"_dispatchEvent\"](ScrollView.EventType.SCROLL_ENG_WITH_THRESHOLD);\n\t\t\tsv[\"_isScrollEndedWithThresholdEventFired\"] = true;\n\t\t}\n\n\t\tif (sv[\"elastic\"]) {\n\t\t\tconst brakeOffsetPosition = clonedAutoScrollStartPosition.clone();\n\t\t\tbrakeOffsetPosition.subtract(sv[\"_autoScrollBrakingStartPosition\"]);\n\t\t\tif (isAutoScrollBrake) {\n\t\t\t\tbrakeOffsetPosition.multiplyScalar(brakingFactor);\n\t\t\t}\n\t\t\tclonedAutoScrollStartPosition.set(sv[\"_autoScrollBrakingStartPosition\"]);\n\t\t\tclonedAutoScrollStartPosition.add(brakeOffsetPosition);\n\t\t} else {\n\t\t\tconst moveDelta = clonedAutoScrollStartPosition.clone();\n\t\t\tmoveDelta.subtract(sv[\"_getContentPosition\"]());\n\t\t\tconst outOfBoundary = sv[\"_getHowMuchOutOfBoundary\"](moveDelta);\n\t\t\tif (!outOfBoundary.equals(ZERO, EPSILON)) {\n\t\t\t\tclonedAutoScrollStartPosition.add(outOfBoundary);\n\t\t\t\treachedEnd = true;\n\t\t\t}\n\t\t}\n\n\t\tif (reachedEnd) {\n\t\t\tsv[\"_autoScrolling\"] = false;\n\t\t}\n\n\t\tconst deltaMove = new Vec3(clonedAutoScrollStartPosition);\n\t\tdeltaMove.subtract(sv[\"_getContentPosition\"]());\n\t\tsv[\"_clampDelta\"](deltaMove);\n\t\tsv[\"_moveContent\"](deltaMove, reachedEnd);\n\t\tsv[\"_dispatchEvent\"](ScrollView.EventType.SCROLLING);\n\n\t\tif (!sv[\"_autoScrolling\"]) {\n\t\t\tsv[\"_isBouncing\"] = false;\n\t\t\tsv[\"_scrolling\"] = false;\n\t\t\tsv[\"_dispatchEvent\"](ScrollView.EventType.SCROLL_ENDED);\n\t\t}\n\t}\n\n\t//设置模板Item\n\tsetTemplateItem(item: any) {\n\t\tif (!item) return;\n\t\tlet t: any = this;\n\t\tt._itemTmp = item;\n\t\tt._itemTmpUt = item.getComponent(UITransform);\n\n\t\tif (t._resizeMode == Layout.ResizeMode.CHILDREN) t._itemSize = t._layout.cellSize;\n\t\telse {\n\t\t\tlet itemUt: UITransform = item.getComponent(UITransform);\n\t\t\tt._itemSize = new Size(itemUt.width, itemUt.height);\n\t\t}\n\n\t\t//获取ListItem，如果没有就取消选择模式\n\t\tlet com: any = item.getComponent(ScrollListItem);\n\t\tlet remove = false;\n\t\tif (!com) remove = true;\n\t\t// if (com) {\n\t\t//     if (!com._btnCom && !item.getComponent(cc.Button)) {\n\t\t//         remove = true;\n\t\t//     }\n\t\t// }\n\t\tif (remove) {\n\t\t\tt.selectedMode = SelectedType.NONE;\n\t\t}\n\t\tcom = item.getComponent(Widget);\n\t\tif (com && com.enabled) {\n\t\t\tt._needUpdateWidget = true;\n\t\t}\n\t\tif (t.selectedMode == SelectedType.MULT) t.multSelected = [];\n\n\t\tswitch (t._align) {\n\t\t\tcase Layout.Type.HORIZONTAL:\n\t\t\t\tt._colLineNum = 1;\n\t\t\t\tt._sizeType = false;\n\t\t\t\tbreak;\n\t\t\tcase Layout.Type.VERTICAL:\n\t\t\t\tt._colLineNum = 1;\n\t\t\t\tt._sizeType = true;\n\t\t\t\tbreak;\n\t\t\tcase Layout.Type.GRID:\n\t\t\t\tswitch (t._startAxis) {\n\t\t\t\t\tcase Layout.AxisDirection.HORIZONTAL:\n\t\t\t\t\t\t//计算列数\n\t\t\t\t\t\tlet trimW: number = t._contentUt.width - t._leftGap - t._rightGap;\n\t\t\t\t\t\tt._colLineNum = Math.floor((trimW + t._columnGap) / (t._itemSize.width + t._columnGap));\n\t\t\t\t\t\tt._sizeType = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Layout.AxisDirection.VERTICAL:\n\t\t\t\t\t\t//计算行数\n\t\t\t\t\t\tlet trimH: number = t._contentUt.height - t._topGap - t._bottomGap;\n\t\t\t\t\t\tt._colLineNum = Math.floor((trimH + t._lineGap) / (t._itemSize.height + t._lineGap));\n\t\t\t\t\t\tt._sizeType = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * 检查是否初始化\n\t * @param {Boolean} printLog 是否打印错误信息\n\t * @returns\n\t */\n\tcheckInited(printLog: boolean = true) {\n\t\tif (!this._inited) {\n\t\t\tif (printLog) console.error(\"List initialization not completed!\");\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t//禁用 Layout 组件，自行计算 Content Size\n\t_resizeContent() {\n\t\tlet t: any = this;\n\t\tlet result: number;\n\n\t\tswitch (t._align) {\n\t\t\tcase Layout.Type.HORIZONTAL: {\n\t\t\t\tif (t._customSize) {\n\t\t\t\t\tlet fixed: any = t._getFixedSize(0);\n\t\t\t\t\tresult = t._leftGap + fixed.val + t._itemSize.width * (t._numItems - fixed.count) + t._columnGap * (t._numItems - 1) + t._rightGap;\n\t\t\t\t} else {\n\t\t\t\t\tresult = t._leftGap + t._itemSize.width * t._numItems + t._columnGap * (t._numItems - 1) + t._rightGap;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase Layout.Type.VERTICAL: {\n\t\t\t\tif (t._customSize) {\n\t\t\t\t\tlet fixed: any = t._getFixedSize(0);\n\t\t\t\t\tresult = t._topGap + fixed.val + t._itemSize.height * (t._numItems - fixed.count) + t._lineGap * (t._numItems - 1) + t._bottomGap;\n\t\t\t\t} else {\n\t\t\t\t\tresult = t._topGap + t._itemSize.height * t._numItems + t._lineGap * (t._numItems - 1) + t._bottomGap;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase Layout.Type.GRID: {\n\t\t\t\t//网格模式不支持居中\n\t\t\t\tif (t.lackCenter) t.lackCenter = false;\n\t\t\t\tswitch (t._startAxis) {\n\t\t\t\t\tcase Layout.AxisDirection.HORIZONTAL:\n\t\t\t\t\t\tlet lineNum: number = Math.ceil(t._numItems / t._colLineNum);\n\t\t\t\t\t\tresult = t._topGap + t._itemSize.height * lineNum + t._lineGap * (lineNum - 1) + t._bottomGap;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Layout.AxisDirection.VERTICAL:\n\t\t\t\t\t\tlet colNum: number = Math.ceil(t._numItems / t._colLineNum);\n\t\t\t\t\t\tresult = t._leftGap + t._itemSize.width * colNum + t._columnGap * (colNum - 1) + t._rightGap;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet layout: Layout = t.content.getComponent(Layout);\n\t\tif (layout) layout.enabled = false;\n\n\t\tt._allItemSize = result;\n\t\tt._allItemSizeNoEdge = t._allItemSize - (t._sizeType ? t._topGap + t._bottomGap : t._leftGap + t._rightGap);\n\n\t\tif (t.cyclic) {\n\t\t\tlet totalSize: number = t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width;\n\n\t\t\tt._cyclicPos1 = 0;\n\t\t\ttotalSize -= t._cyclicPos1;\n\t\t\tt._cyclicNum = Math.ceil(totalSize / t._allItemSizeNoEdge) + 1;\n\t\t\tlet spacing: number = t._sizeType ? t._lineGap : t._columnGap;\n\t\t\tt._cyclicPos2 = t._cyclicPos1 + t._allItemSizeNoEdge + spacing;\n\t\t\tt._cyclicAllItemSize = t._allItemSize + t._allItemSizeNoEdge * (t._cyclicNum - 1) + spacing * (t._cyclicNum - 1);\n\t\t\tt._cycilcAllItemSizeNoEdge = t._allItemSizeNoEdge * t._cyclicNum;\n\t\t\tt._cycilcAllItemSizeNoEdge += spacing * (t._cyclicNum - 1);\n\t\t\t// cc.log('_cyclicNum ->', t._cyclicNum, t._allItemSizeNoEdge, t._allItemSize, t._cyclicPos1, t._cyclicPos2);\n\t\t}\n\n\t\tt._lack = !t.cyclic && t._allItemSize < (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width);\n\t\tlet slideOffset: number = (!t._lack || !t.lackCenter) && t.lackSlide ? 0 : 0.1;\n\n\t\tlet targetWH: number = t._lack ? (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width) - slideOffset : t.cyclic ? t._cyclicAllItemSize : t._allItemSize;\n\t\tif (targetWH < 0) targetWH = 0;\n\n\t\tif (t._sizeType) {\n\t\t\tt._contentUt.height = targetWH;\n\t\t} else {\n\t\t\tt._contentUt.width = targetWH;\n\t\t}\n\n\t\t// cc.log('_resizeContent()  numItems =', t._numItems, '，content =', t.content);\n\t}\n\n\t//滚动进行时...\n\t_onScrolling(ev: Event = undefined) {\n\t\tif (this.contentLayerType === LayerType.SLICE) {\n\t\t\tthis._contentList.forEach((content) => {\n\t\t\t\tcontent.position = this.content.position;\n\t\t\t});\n\t\t}\n\t\tif (this.frameCount === undefined) this.frameCount = this._updateRate;\n\t\tif (!this._forceUpdate && ev && ev.type != \"scroll-ended\" && this.frameCount > 0) {\n\t\t\tthis.frameCount--;\n\t\t\treturn;\n\t\t} else this.frameCount = this._updateRate;\n\n\t\tif (this._aniDelRuning) return;\n\n\t\t//循环列表处理\n\t\tif (this.cyclic) {\n\t\t\tlet scrollPos: any = this.content.getPosition();\n\t\t\tscrollPos = this._sizeType ? scrollPos.y : scrollPos.x;\n\n\t\t\tlet addVal = this._allItemSizeNoEdge + (this._sizeType ? this._lineGap : this._columnGap);\n\t\t\tlet add: any = this._sizeType ? new Vec3(0, addVal, 0) : new Vec3(addVal, 0, 0);\n\n\t\t\tlet contentPos = this.content.getPosition();\n\n\t\t\tswitch (this._alignCalcType) {\n\t\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\t\tif (scrollPos > -this._cyclicPos1) {\n\t\t\t\t\t\tcontentPos.set(-this._cyclicPos2, contentPos.y, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].subtract(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if (this._beganPos) {\n\t\t\t\t\t\t//     this._beganPos += add;\n\t\t\t\t\t\t// }\n\t\t\t\t\t} else if (scrollPos < -this._cyclicPos2) {\n\t\t\t\t\t\tcontentPos.set(-this._cyclicPos1, contentPos.y, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].add(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if (this._beganPos) {\n\t\t\t\t\t\t//     this._beganPos -= add;\n\t\t\t\t\t\t// }\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\t\tif (scrollPos < this._cyclicPos1) {\n\t\t\t\t\t\tcontentPos.set(this._cyclicPos2, contentPos.y, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].add(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (scrollPos > this._cyclicPos2) {\n\t\t\t\t\t\tcontentPos.set(this._cyclicPos1, contentPos.y, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].subtract(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\t\tif (scrollPos < this._cyclicPos1) {\n\t\t\t\t\t\tcontentPos.set(contentPos.x, this._cyclicPos2, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].add(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (scrollPos > this._cyclicPos2) {\n\t\t\t\t\t\tcontentPos.set(contentPos.x, this._cyclicPos1, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].subtract(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\t\tif (scrollPos > -this._cyclicPos1) {\n\t\t\t\t\t\tcontentPos.set(contentPos.x, -this._cyclicPos2, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].subtract(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (scrollPos < -this._cyclicPos2) {\n\t\t\t\t\t\tcontentPos.set(contentPos.x, -this._cyclicPos1, contentPos.z);\n\t\t\t\t\t\tthis.content.setPosition(contentPos);\n\t\t\t\t\t\tif (this._scrollView.isAutoScrolling()) {\n\t\t\t\t\t\t\tthis._scrollView[\"_autoScrollStartPosition\"] = this._scrollView[\"_autoScrollStartPosition\"].add(add);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis._calcViewPos();\n\n\t\tlet vTop: number, vRight: number, vBottom: number, vLeft: number;\n\t\tif (this._sizeType) {\n\t\t\tvTop = this.viewTop;\n\t\t\tvBottom = this.viewBottom;\n\t\t} else {\n\t\t\tvRight = this.viewRight;\n\t\t\tvLeft = this.viewLeft;\n\t\t}\n\n\t\tif (this._virtual) {\n\t\t\tthis.displayData = [];\n\t\t\tlet itemPos: any;\n\n\t\t\tlet curId: number = 0;\n\t\t\tlet endId: number = this._numItems - 1;\n\n\t\t\tif (this._customSize) {\n\t\t\t\tlet breakFor: boolean = false;\n\t\t\t\t//如果该item的位置在可视区域内，就推入displayData\n\t\t\t\tfor (; curId <= endId && !breakFor; curId++) {\n\t\t\t\t\titemPos = this._calcItemPos(curId);\n\t\t\t\t\tswitch (this._align) {\n\t\t\t\t\t\tcase Layout.Type.HORIZONTAL:\n\t\t\t\t\t\t\tif (itemPos.right >= vLeft && itemPos.left <= vRight) {\n\t\t\t\t\t\t\t\tthis.displayData.push(itemPos);\n\t\t\t\t\t\t\t} else if (curId != 0 && this.displayData.length > 0) {\n\t\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase Layout.Type.VERTICAL:\n\t\t\t\t\t\t\tif (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\n\t\t\t\t\t\t\t\tthis.displayData.push(itemPos);\n\t\t\t\t\t\t\t} else if (curId != 0 && this.displayData.length > 0) {\n\t\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase Layout.Type.GRID:\n\t\t\t\t\t\t\tswitch (this._startAxis) {\n\t\t\t\t\t\t\t\tcase Layout.AxisDirection.HORIZONTAL:\n\t\t\t\t\t\t\t\t\tif (itemPos.bottom <= vTop && itemPos.top >= vBottom) {\n\t\t\t\t\t\t\t\t\t\tthis.displayData.push(itemPos);\n\t\t\t\t\t\t\t\t\t} else if (curId != 0 && this.displayData.length > 0) {\n\t\t\t\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase Layout.AxisDirection.VERTICAL:\n\t\t\t\t\t\t\t\t\tif (itemPos.right >= vLeft && itemPos.left <= vRight) {\n\t\t\t\t\t\t\t\t\t\tthis.displayData.push(itemPos);\n\t\t\t\t\t\t\t\t\t} else if (curId != 0 && this.displayData.length > 0) {\n\t\t\t\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet ww: number = this._itemSize.width + this._columnGap;\n\t\t\t\tlet hh: number = this._itemSize.height + this._lineGap;\n\t\t\t\tswitch (this._alignCalcType) {\n\t\t\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\t\t\tcurId = (vLeft - this._leftGap) / ww;\n\t\t\t\t\t\tendId = (vRight - this._leftGap) / ww;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\t\t\tcurId = (-vRight - this._rightGap) / ww;\n\t\t\t\t\t\tendId = (-vLeft - this._rightGap) / ww;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\t\t\tcurId = (-vTop - this._topGap) / hh;\n\t\t\t\t\t\tendId = (-vBottom - this._topGap) / hh;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\t\t\tcurId = (vBottom - this._bottomGap) / hh;\n\t\t\t\t\t\tendId = (vTop - this._bottomGap) / hh;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcurId = Math.floor(curId) * this._colLineNum;\n\t\t\t\tendId = Math.ceil(endId) * this._colLineNum;\n\t\t\t\tendId--;\n\t\t\t\tif (curId < 0 || curId == -0) curId = 0;\n\t\t\t\tif (endId >= this._numItems) endId = this._numItems - 1;\n\t\t\t\tfor (; curId <= endId; curId++) {\n\t\t\t\t\tthis.displayData.push(this._calcItemPos(curId));\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._delRedundantItem();\n\t\t\tif (this.displayData.length <= 0 || !this._numItems) {\n\t\t\t\t//if none, delete all.\n\t\t\t\tthis._lastDisplayData = [];\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.firstListId = this.displayData[0].id;\n\t\t\tthis.displayItemNum = this.displayData.length;\n\n\t\t\tlet len: number = this._lastDisplayData.length;\n\n\t\t\tlet haveDataChange: boolean = this.displayItemNum != len;\n\t\t\tif (haveDataChange) {\n\t\t\t\t// 如果是逐帧渲染，需要排序\n\t\t\t\tif (this.frameByFrameRenderNum > 0) {\n\t\t\t\t\tthis._lastDisplayData.sort((a, b) => {\n\t\t\t\t\t\treturn a - b;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// 因List的显示数据是有序的，所以只需要判断数组长度是否相等，以及头、尾两个元素是否相等即可。\n\t\t\t\thaveDataChange = this.firstListId != this._lastDisplayData[0] || this.displayData[this.displayItemNum - 1].id != this._lastDisplayData[len - 1];\n\t\t\t}\n\n\t\t\tif (this._forceUpdate || haveDataChange) {\n\t\t\t\t//如果是强制更新\n\t\t\t\tif (this.frameByFrameRenderNum > 0) {\n\t\t\t\t\t// if (this._updateDone) {\n\t\t\t\t\t// this._lastDisplayData = [];\n\t\t\t\t\t//逐帧渲染\n\t\t\t\t\tif (this._numItems > 0) {\n\t\t\t\t\t\tif (!this._updateDone) {\n\t\t\t\t\t\t\tthis._doneAfterUpdate = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._updateCounter = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._updateDone = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._updateCounter = 0;\n\t\t\t\t\t\tthis._updateDone = true;\n\t\t\t\t\t}\n\t\t\t\t\t// }\n\t\t\t\t} else {\n\t\t\t\t\t//直接渲染\n\t\t\t\t\tthis._lastDisplayData = [];\n\t\t\t\t\t// cc.log('List Display Data II::', this.displayData);\n\t\t\t\t\tfor (let c = 0; c < this.displayItemNum; c++) {\n\t\t\t\t\t\tthis._createOrUpdateItem(this.displayData[c], this._showAnimation);\n\t\t\t\t\t}\n\t\t\t\t\tthis._showAnimation = false;\n\t\t\t\t\tthis._forceUpdate = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._calcNearestItem();\n\t\t}\n\t}\n\n\t//计算可视范围\n\t_calcViewPos() {\n\t\tlet scrollPos: any = this.content.getPosition();\n\t\tswitch (this._alignCalcType) {\n\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\tthis.elasticLeft = scrollPos.x > 0 ? scrollPos.x : 0;\n\t\t\t\tthis.viewLeft = (scrollPos.x < 0 ? -scrollPos.x : 0) - this.elasticLeft;\n\n\t\t\t\tthis.viewRight = this.viewLeft + this._thisNodeUt.width;\n\t\t\t\tthis.elasticRight = this.viewRight > this._contentUt.width ? Math.abs(this.viewRight - this._contentUt.width) : 0;\n\t\t\t\tthis.viewRight += this.elasticRight;\n\t\t\t\t// cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\n\t\t\t\tbreak;\n\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\tthis.elasticRight = scrollPos.x < 0 ? -scrollPos.x : 0;\n\t\t\t\tthis.viewRight = (scrollPos.x > 0 ? -scrollPos.x : 0) + this.elasticRight;\n\t\t\t\tthis.viewLeft = this.viewRight - this._thisNodeUt.width;\n\t\t\t\tthis.elasticLeft = this.viewLeft < -this._contentUt.width ? Math.abs(this.viewLeft + this._contentUt.width) : 0;\n\t\t\t\tthis.viewLeft -= this.elasticLeft;\n\t\t\t\t// cc.log(this.elasticLeft, this.elasticRight, this.viewLeft, this.viewRight);\n\t\t\t\tbreak;\n\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\tthis.elasticTop = scrollPos.y < 0 ? Math.abs(scrollPos.y) : 0;\n\t\t\t\tthis.viewTop = (scrollPos.y > 0 ? -scrollPos.y : 0) + this.elasticTop;\n\t\t\t\tthis.viewBottom = this.viewTop - this._thisNodeUt.height;\n\t\t\t\tthis.elasticBottom = this.viewBottom < -this._contentUt.height ? Math.abs(this.viewBottom + this._contentUt.height) : 0;\n\t\t\t\tthis.viewBottom += this.elasticBottom;\n\t\t\t\t// cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\n\t\t\t\tbreak;\n\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\tthis.elasticBottom = scrollPos.y > 0 ? Math.abs(scrollPos.y) : 0;\n\t\t\t\tthis.viewBottom = (scrollPos.y < 0 ? -scrollPos.y : 0) - this.elasticBottom;\n\t\t\t\tthis.viewTop = this.viewBottom + this._thisNodeUt.height;\n\t\t\t\tthis.elasticTop = this.viewTop > this._contentUt.height ? Math.abs(this.viewTop - this._contentUt.height) : 0;\n\t\t\t\tthis.viewTop -= this.elasticTop;\n\t\t\t\t// cc.log(this.elasticTop, this.elasticBottom, this.viewTop, this.viewBottom);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t//计算位置 根据id\n\t_calcItemPos(id: number) {\n\t\tlet width: number, height: number, top: number, bottom: number, left: number, right: number, itemX: number, itemY: number;\n\t\tswitch (this._align) {\n\t\t\tcase Layout.Type.HORIZONTAL:\n\t\t\t\tswitch (this._horizontalDir) {\n\t\t\t\t\tcase Layout.HorizontalDirection.LEFT_TO_RIGHT: {\n\t\t\t\t\t\tif (this._customSize) {\n\t\t\t\t\t\t\tlet fixed: any = this._getFixedSize(id);\n\t\t\t\t\t\t\tleft = this._leftGap + (this._itemSize.width + this._columnGap) * (id - fixed.count) + (fixed.val + this._columnGap * fixed.count);\n\t\t\t\t\t\t\tlet cs: number = this._customSize[id];\n\t\t\t\t\t\t\twidth = cs > 0 ? cs : this._itemSize.width;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tleft = this._leftGap + (this._itemSize.width + this._columnGap) * id;\n\t\t\t\t\t\t\twidth = this._itemSize.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.lackCenter) {\n\t\t\t\t\t\t\tleft -= this._leftGap;\n\t\t\t\t\t\t\tlet offset: number = this._contentUt.width / 2 - this._allItemSizeNoEdge / 2;\n\t\t\t\t\t\t\tleft += offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tright = left + width;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\tright: right,\n\t\t\t\t\t\t\tx: left + this._itemTmpUt.anchorX * width,\n\t\t\t\t\t\t\ty: this._itemTmp.y,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tcase Layout.HorizontalDirection.RIGHT_TO_LEFT: {\n\t\t\t\t\t\tif (this._customSize) {\n\t\t\t\t\t\t\tlet fixed: any = this._getFixedSize(id);\n\t\t\t\t\t\t\tright = -this._rightGap - (this._itemSize.width + this._columnGap) * (id - fixed.count) - (fixed.val + this._columnGap * fixed.count);\n\t\t\t\t\t\t\tlet cs: number = this._customSize[id];\n\t\t\t\t\t\t\twidth = cs > 0 ? cs : this._itemSize.width;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tright = -this._rightGap - (this._itemSize.width + this._columnGap) * id;\n\t\t\t\t\t\t\twidth = this._itemSize.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.lackCenter) {\n\t\t\t\t\t\t\tright += this._rightGap;\n\t\t\t\t\t\t\tlet offset: number = this._contentUt.width / 2 - this._allItemSizeNoEdge / 2;\n\t\t\t\t\t\t\tright -= offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tleft = right - width;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\tright: right,\n\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\tx: left + this._itemTmpUt.anchorX * width,\n\t\t\t\t\t\t\ty: this._itemTmp.y,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Layout.Type.VERTICAL: {\n\t\t\t\tswitch (this._verticalDir) {\n\t\t\t\t\tcase Layout.VerticalDirection.TOP_TO_BOTTOM: {\n\t\t\t\t\t\tif (this._customSize) {\n\t\t\t\t\t\t\tlet fixed: any = this._getFixedSize(id);\n\t\t\t\t\t\t\ttop = -this._topGap - (this._itemSize.height + this._lineGap) * (id - fixed.count) - (fixed.val + this._lineGap * fixed.count);\n\t\t\t\t\t\t\tlet cs: number = this._customSize[id];\n\t\t\t\t\t\t\theight = cs > 0 ? cs : this._itemSize.height;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttop = -this._topGap - (this._itemSize.height + this._lineGap) * id;\n\t\t\t\t\t\t\theight = this._itemSize.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.lackCenter) {\n\t\t\t\t\t\t\ttop += this._topGap;\n\t\t\t\t\t\t\tlet offset: number = this._contentUt.height / 2 - this._allItemSizeNoEdge / 2;\n\t\t\t\t\t\t\ttop -= offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbottom = top - height;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\ttop: top,\n\t\t\t\t\t\t\tbottom: bottom,\n\t\t\t\t\t\t\tx: this._itemTmp.x,\n\t\t\t\t\t\t\ty: bottom + this._itemTmpUt.anchorY * height,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tcase Layout.VerticalDirection.BOTTOM_TO_TOP: {\n\t\t\t\t\t\tif (this._customSize) {\n\t\t\t\t\t\t\tlet fixed: any = this._getFixedSize(id);\n\t\t\t\t\t\t\tbottom = this._bottomGap + (this._itemSize.height + this._lineGap) * (id - fixed.count) + (fixed.val + this._lineGap * fixed.count);\n\t\t\t\t\t\t\tlet cs: number = this._customSize[id];\n\t\t\t\t\t\t\theight = cs > 0 ? cs : this._itemSize.height;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbottom = this._bottomGap + (this._itemSize.height + this._lineGap) * id;\n\t\t\t\t\t\t\theight = this._itemSize.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.lackCenter) {\n\t\t\t\t\t\t\tbottom -= this._bottomGap;\n\t\t\t\t\t\t\tlet offset: number = this._contentUt.height / 2 - this._allItemSizeNoEdge / 2;\n\t\t\t\t\t\t\tbottom += offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttop = bottom + height;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\ttop: top,\n\t\t\t\t\t\t\tbottom: bottom,\n\t\t\t\t\t\t\tx: this._itemTmp.x,\n\t\t\t\t\t\t\ty: bottom + this._itemTmpUt.anchorY * height,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase Layout.Type.GRID: {\n\t\t\t\tlet colLine: number = Math.floor(id / this._colLineNum);\n\t\t\t\tswitch (this._startAxis) {\n\t\t\t\t\tcase Layout.AxisDirection.HORIZONTAL: {\n\t\t\t\t\t\tswitch (this._verticalDir) {\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.TOP_TO_BOTTOM: {\n\t\t\t\t\t\t\t\ttop = -this._topGap - (this._itemSize.height + this._lineGap) * colLine;\n\t\t\t\t\t\t\t\tbottom = top - this._itemSize.height;\n\t\t\t\t\t\t\t\titemY = bottom + this._itemTmpUt.anchorY * this._itemSize.height;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.BOTTOM_TO_TOP: {\n\t\t\t\t\t\t\t\tbottom = this._bottomGap + (this._itemSize.height + this._lineGap) * colLine;\n\t\t\t\t\t\t\t\ttop = bottom + this._itemSize.height;\n\t\t\t\t\t\t\t\titemY = bottom + this._itemTmpUt.anchorY * this._itemSize.height;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemX = this._leftGap + (id % this._colLineNum) * (this._itemSize.width + this._columnGap);\n\t\t\t\t\t\tswitch (this._horizontalDir) {\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.LEFT_TO_RIGHT: {\n\t\t\t\t\t\t\t\titemX += this._itemTmpUt.anchorX * this._itemSize.width;\n\t\t\t\t\t\t\t\titemX -= this._contentUt.anchorX * this._contentUt.width;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.RIGHT_TO_LEFT: {\n\t\t\t\t\t\t\t\titemX += (1 - this._itemTmpUt.anchorX) * this._itemSize.width;\n\t\t\t\t\t\t\t\titemX -= (1 - this._contentUt.anchorX) * this._contentUt.width;\n\t\t\t\t\t\t\t\titemX *= -1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\ttop: top,\n\t\t\t\t\t\t\tbottom: bottom,\n\t\t\t\t\t\t\tx: itemX,\n\t\t\t\t\t\t\ty: itemY,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tcase Layout.AxisDirection.VERTICAL: {\n\t\t\t\t\t\tswitch (this._horizontalDir) {\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.LEFT_TO_RIGHT: {\n\t\t\t\t\t\t\t\tleft = this._leftGap + (this._itemSize.width + this._columnGap) * colLine;\n\t\t\t\t\t\t\t\tright = left + this._itemSize.width;\n\t\t\t\t\t\t\t\titemX = left + this._itemTmpUt.anchorX * this._itemSize.width;\n\t\t\t\t\t\t\t\titemX -= this._contentUt.anchorX * this._contentUt.width;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase Layout.HorizontalDirection.RIGHT_TO_LEFT: {\n\t\t\t\t\t\t\t\tright = -this._rightGap - (this._itemSize.width + this._columnGap) * colLine;\n\t\t\t\t\t\t\t\tleft = right - this._itemSize.width;\n\t\t\t\t\t\t\t\titemX = left + this._itemTmpUt.anchorX * this._itemSize.width;\n\t\t\t\t\t\t\t\titemX += (1 - this._contentUt.anchorX) * this._contentUt.width;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemY = -this._topGap - (id % this._colLineNum) * (this._itemSize.height + this._lineGap);\n\t\t\t\t\t\tswitch (this._verticalDir) {\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.TOP_TO_BOTTOM: {\n\t\t\t\t\t\t\t\titemY -= (1 - this._itemTmpUt.anchorY) * this._itemSize.height;\n\t\t\t\t\t\t\t\titemY += (1 - this._contentUt.anchorY) * this._contentUt.height;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase Layout.VerticalDirection.BOTTOM_TO_TOP: {\n\t\t\t\t\t\t\t\titemY -= this._itemTmpUt.anchorY * this._itemSize.height;\n\t\t\t\t\t\t\t\titemY += this._contentUt.anchorY * this._contentUt.height;\n\t\t\t\t\t\t\t\titemY *= -1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\tright: right,\n\t\t\t\t\t\t\tx: itemX,\n\t\t\t\t\t\t\ty: itemY,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t//计算已存在的Item的位置\n\t_calcExistItemPos(id: number) {\n\t\tlet item: any = this.getItemByListId(id);\n\t\tif (!item) return 0;\n\t\tlet ut: UITransform = item.getComponent(UITransform);\n\t\tlet pos: Vec3 = item.getPosition();\n\t\tlet data: any = {\n\t\t\tid: id,\n\t\t\tx: pos.x,\n\t\t\ty: pos.y,\n\t\t};\n\t\tif (this._sizeType) {\n\t\t\tdata.top = pos.y + ut.height * (1 - ut.anchorY);\n\t\t\tdata.bottom = pos.y - ut.height * ut.anchorY;\n\t\t} else {\n\t\t\tdata.left = pos.x - ut.width * ut.anchorX;\n\t\t\tdata.right = pos.x + ut.width * (1 - ut.anchorX);\n\t\t}\n\t\treturn data;\n\t}\n\n\t//获取Item位置\n\tgetItemPos(id: number) {\n\t\tif (this._virtual) return this._calcItemPos(id);\n\t\telse {\n\t\t\tif (this.frameByFrameRenderNum) return this._calcItemPos(id);\n\t\t\telse return this._calcExistItemPos(id);\n\t\t}\n\t}\n\n\t//获取固定尺寸\n\t_getFixedSize(listId: number) {\n\t\tif (!this._customSize) return null;\n\t\tif (listId === 0) listId = this._numItems;\n\t\tlet fixed: number = 0;\n\t\tlet count: number = 0;\n\t\tfor (let id in this._customSize) {\n\t\t\tif (parseInt(id) < listId) {\n\t\t\t\tfixed += this._customSize[id];\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tval: fixed,\n\t\t\tcount: count,\n\t\t};\n\t}\n\n\t//滚动结束时..\n\t_onScrollBegan() {\n\t\tthis._beganPos = this._sizeType ? this.viewTop : this.viewLeft;\n\t\tif (this._slideMode === SlideType.PAGE && !this._beganPos) {\n\t\t\tthis._beganPos = 0;\n\t\t}\n\t}\n\n\t//滚动结束时..\n\t_onScrollEnded() {\n\t\tlet t: any = this;\n\t\tt._curScrollIsTouch = false;\n\t\tif (t.scrollToListId !== 0) {\n\t\t\tlet item: any = t.getItemByListId(t.scrollToListId);\n\t\t\tt.scrollToListId = 0;\n\t\t\tif (item) {\n\t\t\t\ttween(item).to(0.1, { scale: 1.06 }).to(0.1, { scale: 1 }).start();\n\t\t\t}\n\t\t}\n\t\tt._onScrolling();\n\n\t\tif (t._slideMode == SlideType.ADHERING && !t.adhering) {\n\t\t\t//cc.log(t.adhering, t._scrollView.isAutoScrolling(), t._scrollView.isScrolling());\n\t\t\tt.adhere();\n\t\t} else if (t._slideMode == SlideType.PAGE) {\n\t\t\tif (t._beganPos !== 0 && t._curScrollIsTouch) {\n\t\t\t\tthis._pageAdhere();\n\t\t\t} else {\n\t\t\t\tt.adhere();\n\t\t\t}\n\t\t}\n\t}\n\n\t// 触摸时\n\t_onTouchStart(ev, captureListeners) {\n\t\tif (this._scrollView[\"_hasNestedViewGroup\"](ev, captureListeners)) return;\n\t\tthis._curScrollIsTouch = true;\n\t\tlet isMe = ev.eventPhase === Event.AT_TARGET && ev.target === this.node;\n\t\tif (!isMe) {\n\t\t\tlet itemNode: any = ev.target;\n\t\t\twhile (itemNode._listId === 0 && itemNode.parent) itemNode = itemNode.parent;\n\t\t\tthis._scrollItem = itemNode._listId !== 0 ? itemNode : ev.target;\n\t\t}\n\t}\n\n\t//触摸抬起时..\n\t_onTouchUp() {\n\t\tlet t: any = this;\n\t\tt._scrollPos = 0;\n\t\tif (t._slideMode == SlideType.ADHERING) {\n\t\t\tif (this.adhering) this._adheringBarrier = true;\n\t\t\tt.adhere();\n\t\t} else if (t._slideMode == SlideType.PAGE) {\n\t\t\tif (t._beganPos !== 0) {\n\t\t\t\tthis._pageAdhere();\n\t\t\t} else {\n\t\t\t\tt.adhere();\n\t\t\t}\n\t\t}\n\t\tthis._scrollItem = null;\n\t}\n\n\t_onTouchCancelled(ev, captureListeners) {\n\t\tlet t = this;\n\t\tif (t._scrollView[\"_hasNestedViewGroup\"](ev, captureListeners) || ev.simulate) return;\n\n\t\tt._scrollPos = 0;\n\t\tif (t._slideMode == SlideType.ADHERING) {\n\t\t\tif (t.adhering) t._adheringBarrier = true;\n\t\t\tt.adhere();\n\t\t} else if (t._slideMode == SlideType.PAGE) {\n\t\t\tif (t._beganPos !== 0) {\n\t\t\t\tt._pageAdhere();\n\t\t\t} else {\n\t\t\t\tt.adhere();\n\t\t\t}\n\t\t}\n\t\tthis._scrollItem = null;\n\t}\n\n\t//当尺寸改变\n\t_onSizeChanged() {\n\t\tif (this.checkInited(false)) this._onScrolling();\n\t}\n\n\t//当Item自适应\n\t_onItemAdaptive(item: any) {\n\t\tlet ut: UITransform = item.getComponent(UITransform);\n\t\t// if (this.checkInited(false)) {\n\t\tif ((!this._sizeType && ut.width != this._itemSize.width) || (this._sizeType && ut.height != this._itemSize.height)) {\n\t\t\tif (!this._customSize) this._customSize = {};\n\t\t\tlet val = this._sizeType ? ut.height : ut.width;\n\t\t\tif (this._customSize[item._listId] != val) {\n\t\t\t\tthis._customSize[item._listId] = val;\n\t\t\t\tthis._resizeContent();\n\t\t\t\t// this.content.children.forEach((child: Node) => {\n\t\t\t\t//     this._updateItemPos(child);\n\t\t\t\t// });\n\t\t\t\tthis.updateAll();\n\t\t\t\t// 如果当前正在运行 scrollTo，肯定会不准确，在这里做修正\n\t\t\t\tif (this._scrollToListId !== 0) {\n\t\t\t\t\tthis._scrollPos = 0;\n\t\t\t\t\tthis.unschedule(this._scrollToSo);\n\t\t\t\t\tthis.scrollTo(this._scrollToListId, Math.max(0, this._scrollToEndTime - new Date().getTime() / 1000));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// }\n\t}\n\n\t//PAGE粘附\n\t_pageAdhere() {\n\t\tlet t = this;\n\t\tif (!t.cyclic && (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0)) return;\n\t\tlet curPos = t._sizeType ? t.viewTop : t.viewLeft;\n\t\tlet dis = (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width) * t.pageDistance;\n\t\tlet canSkip = Math.abs(t._beganPos - curPos) > dis;\n\t\tif (canSkip) {\n\t\t\tlet timeInSecond = 0.5;\n\t\t\tswitch (t._alignCalcType) {\n\t\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\t\tif (t._beganPos > curPos) {\n\t\t\t\t\t\tt.prePage(timeInSecond);\n\t\t\t\t\t\t// cc.log('_pageAdhere   PPPPPPPPPPPPPPP');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tt.nextPage(timeInSecond);\n\t\t\t\t\t\t// cc.log('_pageAdhere   NNNNNNNNNNNNNNN');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\t\tif (t._beganPos < curPos) {\n\t\t\t\t\t\tt.prePage(timeInSecond);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tt.nextPage(timeInSecond);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (t.elasticTop <= 0 && t.elasticRight <= 0 && t.elasticBottom <= 0 && t.elasticLeft <= 0) {\n\t\t\tt.adhere();\n\t\t}\n\t\tt._beganPos = 0;\n\t}\n\n\t//粘附\n\tadhere() {\n\t\tlet t: any = this;\n\t\tif (!t.checkInited()) return;\n\t\tif (t.elasticTop > 0 || t.elasticRight > 0 || t.elasticBottom > 0 || t.elasticLeft > 0) return;\n\t\tt.adhering = true;\n\t\tt._calcNearestItem();\n\t\tlet offset: number = (t._sizeType ? t._topGap : t._leftGap) / (t._sizeType ? t._thisNodeUt.height : t._thisNodeUt.width);\n\t\tlet timeInSecond: number = 0.7;\n\t\tt.scrollTo(t.nearestListId, timeInSecond, offset);\n\t}\n\n\t//Update..\n\tupdate() {\n\t\tif (this.frameByFrameRenderNum <= 0 || this._updateDone) return;\n\t\t// cc.log(this.displayData.length, this._updateCounter, this.displayData[this._updateCounter]);\n\t\tif (this._virtual) {\n\t\t\tlet len: number = this._updateCounter + this.frameByFrameRenderNum > this.displayItemNum ? this.displayItemNum : this._updateCounter + this.frameByFrameRenderNum;\n\t\t\tfor (let n: number = this._updateCounter; n < len; n++) {\n\t\t\t\tlet data: any = this.displayData[n];\n\t\t\t\tif (data) {\n\t\t\t\t\tthis._createOrUpdateItem(data, this._showAnimation);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._updateCounter >= this.displayItemNum - 1) {\n\t\t\t\t//最后一个\n\t\t\t\tif (this._doneAfterUpdate) {\n\t\t\t\t\tthis._updateCounter = 0;\n\t\t\t\t\tthis._updateDone = false;\n\t\t\t\t\t// if (!this._scrollView.isScrolling())\n\t\t\t\t\tthis._doneAfterUpdate = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis._updateDone = true;\n\t\t\t\t\tthis._delRedundantItem();\n\t\t\t\t\tthis._forceUpdate = false;\n\t\t\t\t\tthis._calcNearestItem();\n\t\t\t\t\tif (this.slideMode == SlideType.PAGE) this.curPageNum = this.nearestListId;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._updateCounter += this.frameByFrameRenderNum;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._updateCounter < this._numItems) {\n\t\t\t\tlet len: number = this._updateCounter + this.frameByFrameRenderNum > this._numItems ? this._numItems : this._updateCounter + this.frameByFrameRenderNum;\n\t\t\t\tfor (let n: number = this._updateCounter; n < len; n++) {\n\t\t\t\t\tthis._createOrUpdateItem2(n);\n\t\t\t\t}\n\t\t\t\tthis._updateCounter += this.frameByFrameRenderNum;\n\t\t\t} else {\n\t\t\t\tthis._updateDone = true;\n\t\t\t\tthis._calcNearestItem();\n\t\t\t\tif (this.slideMode == SlideType.PAGE) this.curPageNum = this.nearestListId;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 创建或更新Item（虚拟列表用）\n\t * @param {Object} data 数据\n\t * @param animate 是否派发播放初始化动画 事件\n\t */\n\t_createOrUpdateItem(data: any, animate: boolean) {\n\t\tlet item: any = this.getItemByListId(data.id),\n\t\t\telementList: Node[] = [];\n\t\tif (!item) {\n\t\t\t//如果不存在\n\t\t\tlet canGet: boolean = this._mainPool.size() > 0;\n\t\t\tif (canGet) {\n\t\t\t\titem = this._mainPool.get();\n\t\t\t\tthis._poolList.forEach((pool, index) => {\n\t\t\t\t\tlet element: any = pool.get();\n\t\t\t\t\telementList.push(element);\n\t\t\t\t});\n\t\t\t\tif (!isValid(item)) {\n\t\t\t\t\titem = instantiate(this._itemTmp);\n\t\t\t\t\tlet component = item.getComponent(ScrollListItem);\n\t\t\t\t\tcomponent.layerNodeList.forEach((node, index) => {\n\t\t\t\t\t\tnode.posV3 = node.position.clone();\n\t\t\t\t\t\telementList.push(node);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = instantiate(this._itemTmp);\n\t\t\t\tlet component = item.getComponent(ScrollListItem);\n\t\t\t\tcomponent.layerNodeList.forEach((node, index) => {\n\t\t\t\t\tnode.posV3 = node.position.clone();\n\t\t\t\t\telementList.push(node);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (item._listId !== data.id) {\n\t\t\t\titem._listId = data.id;\n\t\t\t\telementList.forEach((element: any, index) => {\n\t\t\t\t\telement._listId = data.id;\n\t\t\t\t});\n\t\t\t\tlet ut: UITransform = item.getComponent(UITransform);\n\t\t\t\tut.setContentSize(this._itemSize);\n\t\t\t}\n\t\t\tconst vec3Point: Vec3 = new Vec3(data.x, data.y, 0);\n\t\t\titem.setPosition(vec3Point);\n\t\t\telementList.forEach((element: any, index) => {\n\t\t\t\tconst pos = element.posV3.clone().add(vec3Point);\n\t\t\t\telement.setPosition(pos);\n\t\t\t});\n\t\t\tthis._resetItemSize(item);\n\t\t\tthis.content.addChild(item);\n\t\t\telementList.forEach((element, index) => {\n\t\t\t\telement.parent = this._contentList[index];\n\t\t\t});\n\t\t\tif (this._needUpdateWidget) {\n\t\t\t\tlet widget: Widget = item.getComponent(Widget);\n\t\t\t\tif (widget) widget.updateAlignment();\n\t\t\t}\n\t\t\titem.setSiblingIndex(this.content.children.length - 1);\n\n\t\t\tlet listItem: ScrollListItem = item.getComponent(ScrollListItem);\n\t\t\titem[\"listItem\"] = listItem;\n\t\t\tif (listItem) {\n\t\t\t\tlistItem.listId = data.id;\n\t\t\t\tlistItem.list = this;\n\t\t\t\tlistItem._registerEvent();\n\t\t\t}\n\t\t\tif (this.renderEvent) {\n\t\t\t\tEventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\n\t\t\t}\n\t\t} else if (this._forceUpdate && this.renderEvent) {\n\t\t\t//强制更新\n\t\t\titem.setPosition(new Vec3(data.x, data.y, 0));\n\t\t\tthis._resetItemSize(item);\n\t\t\t// cc.log('ADD::', data.id, item);\n\t\t\tif (this.renderEvent) {\n\t\t\t\tEventHandler.emitEvents([this.renderEvent], item, data.id % this._actualNumItems);\n\t\t\t}\n\t\t}\n\t\tthis._resetItemSize(item);\n\n\t\tthis._updateListItem(item[\"listItem\"]);\n\t\tif (this._lastDisplayData.indexOf(data.id) < 0) {\n\t\t\tthis._lastDisplayData.push(data.id);\n\t\t}\n\t\tif (animate && this.animationEvent) {\n\t\t\tEventHandler.emitEvents([this.animationEvent], item, data.id % this._actualNumItems);\n\t\t}\n\t}\n\n\t//创建或更新Item（非虚拟列表用）\n\t_createOrUpdateItem2(listId: number) {\n\t\tlet item: any = this.content.children[listId],\n\t\t\telementList = [];\n\t\tlet listItem: ScrollListItem;\n\t\tif (!item) {\n\t\t\t//如果不存在\n\t\t\titem = instantiate(this._itemTmp);\n\t\t\tlet component = item.getComponent(ScrollListItem);\n\t\t\tcomponent.layerNodeList.forEach((node, index) => {\n\t\t\t\tnode.posV3 = node.position.clone();\n\t\t\t\telementList.push(node);\n\t\t\t});\n\t\t\titem._listId = listId;\n\t\t\tthis.content.addChild(item);\n\t\t\telementList.forEach((element, index) => {\n\t\t\t\telement._listId = listId;\n\t\t\t\telement.parent = this._contentList[index];\n\t\t\t});\n\t\t\tlistItem = item.getComponent(ScrollListItem);\n\t\t\titem[\"listItem\"] = listItem;\n\t\t\tif (listItem) {\n\t\t\t\tlistItem.listId = listId;\n\t\t\t\tlistItem.list = this;\n\t\t\t\tlistItem._registerEvent();\n\t\t\t}\n\t\t\tif (this.renderEvent) {\n\t\t\t\tEventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\n\t\t\t}\n\t\t} else if (this._forceUpdate && this.renderEvent) {\n\t\t\t//强制更新\n\t\t\titem._listId = listId;\n\t\t\telementList.forEach((element, index) => {\n\t\t\t\telement._listId = listId;\n\t\t\t\telement.parent = this._contentList[index];\n\t\t\t});\n\t\t\tif (listItem) listItem.listId = listId;\n\t\t\tif (this.renderEvent) {\n\t\t\t\tEventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\n\t\t\t}\n\t\t}\n\t\tthis._updateListItem(listItem);\n\t\tif (this._lastDisplayData.indexOf(listId) < 0) {\n\t\t\tthis._lastDisplayData.push(listId);\n\t\t}\n\t}\n\n\t_updateListItem(listItem: ScrollListItem) {\n\t\tif (!listItem) return;\n\t\tif (this.selectedMode > SelectedType.NONE) {\n\t\t\tlet item: any = listItem.node;\n\t\t\tswitch (this.selectedMode) {\n\t\t\t\tcase SelectedType.SINGLE:\n\t\t\t\t\tlistItem.selected = this.selectedId == item._listId;\n\t\t\t\t\tbreak;\n\t\t\t\tcase SelectedType.MULT:\n\t\t\t\t\tlistItem.selected = this.multSelected.indexOf(item._listId) >= 0;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t//仅虚拟列表用\n\t_resetItemSize(item: any) {\n\t\t// return;\n\t\tlet size: number;\n\t\tlet ut: UITransform = item.getComponent(UITransform);\n\t\tif (this._customSize && this._customSize[item._listId]) {\n\t\t\tsize = this._customSize[item._listId];\n\t\t} else {\n\t\t\tif (this._colLineNum > 1) ut.setContentSize(this._itemSize);\n\t\t\telse size = this._sizeType ? this._itemSize.height : this._itemSize.width;\n\t\t}\n\t\tif (size) {\n\t\t\tif (this._sizeType) ut.height = size;\n\t\t\telse ut.width = size;\n\t\t}\n\t}\n\n\t/**\n\t * 更新Item位置\n\t * @param {Number||Node} listIdOrItem\n\t */\n\t_updateItemPos(listIdOrItem: any) {\n\t\tlet item: any = isNaN(listIdOrItem) ? listIdOrItem : this.getItemByListId(listIdOrItem);\n\t\tlet pos: any = this.getItemPos(item._listId);\n\t\titem.setPosition(pos.x, pos.y);\n\t}\n\n\t/**\n\t * 设置多选\n\t * @param {Array} args 可以是单个listId，也可是个listId数组\n\t * @param {Boolean} bool 值，如果为null的话，则直接用args覆盖\n\t */\n\tsetMultSelected(args: any, bool: boolean) {\n\t\tlet t: any = this;\n\t\tif (!t.checkInited()) return;\n\t\tif (!Array.isArray(args)) {\n\t\t\targs = [args];\n\t\t}\n\t\tif (bool === false) {\n\t\t\tt.multSelected = args;\n\t\t} else {\n\t\t\tlet listId: number, sub: number;\n\t\t\tif (bool) {\n\t\t\t\tfor (let n: number = args.length - 1; n >= 0; n--) {\n\t\t\t\t\tlistId = args[n];\n\t\t\t\t\tsub = t.multSelected.indexOf(listId);\n\t\t\t\t\tif (sub < 0) {\n\t\t\t\t\t\tt.multSelected.push(listId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (let n: number = args.length - 1; n >= 0; n--) {\n\t\t\t\t\tlistId = args[n];\n\t\t\t\t\tsub = t.multSelected.indexOf(listId);\n\t\t\t\t\tif (sub >= 0) {\n\t\t\t\t\t\tt.multSelected.splice(sub, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tt._forceUpdate = true;\n\t\tt._onScrolling();\n\t}\n\n\t/**\n\t * 获取多选数据\n\t * @returns\n\t */\n\tgetMultSelected() {\n\t\treturn this.multSelected;\n\t}\n\n\t/**\n\t * 多选是否有选择\n\t * @param {number} listId 索引\n\t * @returns\n\t */\n\thasMultSelected(listId: number) {\n\t\treturn this.multSelected && this.multSelected.indexOf(listId) >= 0;\n\t}\n\n\t/**\n\t * 更新指定的Item\n\t * @param {Array} args 单个listId，或者数组\n\t * @returns\n\t */\n\tupdateItem(args: any) {\n\t\tif (!this.checkInited()) return;\n\t\tif (!Array.isArray(args)) {\n\t\t\targs = [args];\n\t\t}\n\t\tfor (let n: number = 0, len: number = args.length; n < len; n++) {\n\t\t\tlet listId: number = args[n];\n\t\t\tlet item: any = this.getItemByListId(listId);\n\t\t\tif (item) EventHandler.emitEvents([this.renderEvent], item, listId % this._actualNumItems);\n\t\t}\n\t}\n\n\t/**\n\t * 更新全部\n\t */\n\tupdateAll() {\n\t\tif (!this.checkInited()) return;\n\t\tthis.numItems = this.numItems;\n\t}\n\n\t/**\n\t * 根据ListID获取Item\n\t * @param {Number} listId\n\t * @param content\n\t * @returns\n\t */\n\tgetItemByListId(listId: number, content?: Node) {\n\t\tcontent = content || this.content;\n\t\tif (content) {\n\t\t\tfor (let n: number = content.children.length - 1; n >= 0; n--) {\n\t\t\t\tlet item: any = content.children[n];\n\t\t\t\tif (item._listId === listId) return item;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 获取在显示区域外的Item\n\t * @returns\n\t */\n\t_getOutsideItem(content?: Node) {\n\t\tcontent = content || this.content;\n\t\tlet item: any;\n\t\tlet result: any[] = [];\n\t\tfor (let n: number = content.children.length - 1; n >= 0; n--) {\n\t\t\titem = content.children[n];\n\t\t\tif (!this.displayData.find((d) => d.id === item._listId)) {\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\t//删除显示区域以外的Item\n\t_delRedundantItem() {\n\t\tif (this._virtual) {\n\t\t\tlet arr: any[] = this._getOutsideItem();\n\t\t\tfor (let n: number = arr.length - 1; n >= 0; n--) {\n\t\t\t\tlet item: any = arr[n];\n\t\t\t\tif (this._scrollItem && item._listId === this._scrollItem._listId) continue;\n\t\t\t\titem.isCached = true;\n\t\t\t\tthis._mainPool.put(item);\n\t\t\t\tfor (let m: number = this._lastDisplayData.length - 1; m >= 0; m--) {\n\t\t\t\t\tif (this._lastDisplayData[m] === item._listId) {\n\t\t\t\t\t\tthis._lastDisplayData.splice(m, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._contentList.forEach((content, index) => {\n\t\t\t\tlet arr: any[] = this._getOutsideItem(content);\n\t\t\t\tfor (let n: number = arr.length - 1; n >= 0; n--) {\n\t\t\t\t\tlet item: any = arr[n];\n\t\t\t\t\tif (this._scrollItem && item._listId === this._scrollItem._listId) continue;\n\t\t\t\t\tthis._poolList[index].put(item);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\twhile (this.content.children.length > this._numItems) {\n\t\t\t\tthis._delSingleItem(this.content.children[this.content.children.length - 1]);\n\t\t\t}\n\t\t\tthis._contentList.forEach((content, index) => {\n\t\t\t\twhile (content.children.length > this._numItems) {\n\t\t\t\t\tthis._delSingleItem(content.children[content.children.length - 1]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t//删除单个Item\n\t_delSingleItem(item: any) {\n\t\t// cc.log('DEL::', item['_listId'], item);\n\t\titem.removeFromParent();\n\t\tif (item.destroy) item.destroy();\n\t\titem = null;\n\t}\n\n\t/**\n\t * 动效删除Item（此方法只适用于虚拟列表，即_virtual=true）\n\t * 一定要在回调函数里重新设置新的numItems进行刷新，毕竟本List是靠数据驱动的。\n\t */\n\taniDelItem(listId: number, callFunc: Function, aniType: number) {\n\t\tlet t: any = this;\n\n\t\tif (!t.checkInited() || t.cyclic || !t._virtual) return console.error(\"This function is not allowed to be called!\");\n\n\t\tif (!callFunc) return console.error(\"CallFunc are not allowed to be NULL, You need to delete the corresponding index in the data array in the CallFunc!\");\n\n\t\tif (t._aniDelRuning) return console.warn(\"Please wait for the current deletion to finish!\");\n\n\t\tlet item: any = t.getItemByListId(listId);\n\t\tlet listItem: ScrollListItem;\n\t\tif (!item) {\n\t\t\tcallFunc(listId);\n\t\t\treturn;\n\t\t} else {\n\t\t\tlistItem = item.getComponent(ScrollListItem);\n\t\t}\n\t\tt._aniDelRuning = true;\n\t\tt._aniDelCB = callFunc;\n\t\tt._aniDelItem = item;\n\t\tt._aniDelBeforePos = item.position;\n\t\tt._aniDelBeforeScale = item.scale;\n\t\tlet curLastId: number = t.displayData[t.displayData.length - 1].id;\n\t\tlet resetSelectedId: boolean = listItem.selected;\n\t\tlistItem.showAni(\n\t\t\taniType,\n\t\t\t() => {\n\t\t\t\t//判断有没有下一个，如果有的话，创建粗来\n\t\t\t\tlet newId: number;\n\t\t\t\tif (curLastId < t._numItems - 2) {\n\t\t\t\t\tnewId = curLastId + 1;\n\t\t\t\t}\n\t\t\t\tif (newId !== 0) {\n\t\t\t\t\tlet newData: any = t._calcItemPos(newId);\n\t\t\t\t\tt.displayData.push(newData);\n\t\t\t\t\tif (t._virtual) t._createOrUpdateItem(newData, t._showAnimation);\n\t\t\t\t\telse t._createOrUpdateItem2(newId);\n\t\t\t\t} else t._numItems--;\n\t\t\t\tif (t.selectedMode == SelectedType.SINGLE) {\n\t\t\t\t\tif (resetSelectedId) {\n\t\t\t\t\t\tt._selectedId = -1;\n\t\t\t\t\t} else if (t._selectedId - 1 >= 0) {\n\t\t\t\t\t\tt._selectedId--;\n\t\t\t\t\t}\n\t\t\t\t} else if (t.selectedMode == SelectedType.MULT && t.multSelected.length) {\n\t\t\t\t\tlet sub: number = t.multSelected.indexOf(listId);\n\t\t\t\t\tif (sub >= 0) {\n\t\t\t\t\t\tt.multSelected.splice(sub, 1);\n\t\t\t\t\t}\n\t\t\t\t\t//多选的数据，在其后的全部减一\n\t\t\t\t\tfor (let n: number = t.multSelected.length - 1; n >= 0; n--) {\n\t\t\t\t\t\tlet id: number = t.multSelected[n];\n\t\t\t\t\t\tif (id >= listId) t.multSelected[n]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t._customSize) {\n\t\t\t\t\tif (t._customSize[listId]) delete t._customSize[listId];\n\t\t\t\t\tlet newCustomSize: any = {};\n\t\t\t\t\tlet size: number;\n\t\t\t\t\tfor (let id in t._customSize) {\n\t\t\t\t\t\tsize = t._customSize[id];\n\t\t\t\t\t\tlet idNumber: number = parseInt(id);\n\t\t\t\t\t\tnewCustomSize[idNumber - (idNumber >= listId ? 1 : 0)] = size;\n\t\t\t\t\t}\n\t\t\t\t\tt._customSize = newCustomSize;\n\t\t\t\t}\n\t\t\t\t//后面的Item向前怼的动效\n\t\t\t\tlet sec: number = 0.2333;\n\t\t\t\tlet twe: Tween<Node>, haveCB: boolean;\n\t\t\t\tfor (let n: number = newId !== 0 ? newId : curLastId; n >= listId + 1; n--) {\n\t\t\t\t\titem = t.getItemByListId(n);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\tlet posData: any = t._calcItemPos(n - 1);\n\t\t\t\t\t\ttwe = tween(item).to(sec, { position: new Vec3(posData.x, posData.y, 0) });\n\n\t\t\t\t\t\tif (n <= listId + 1) {\n\t\t\t\t\t\t\thaveCB = true;\n\t\t\t\t\t\t\ttwe.call(() => {\n\t\t\t\t\t\t\t\tt._aniDelRuning = false;\n\t\t\t\t\t\t\t\tcallFunc(listId);\n\t\t\t\t\t\t\t\tdelete t._aniDelCB;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttwe.start();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!haveCB) {\n\t\t\t\t\tt._aniDelRuning = false;\n\t\t\t\t\tcallFunc(listId);\n\t\t\t\t\tt._aniDelCB = null;\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\t/**\n\t * 滚动到..\n\t * @param {Number} listId 索引（如果<0，则滚到首个Item位置，如果>=_numItems，则滚到最末Item位置）\n\t * @param {Number} timeInSecond 时间\n\t * @param {Number} offset 索引目标位置偏移，0-1\n\t * @param {Boolean} overStress 滚动后是否强调该Item（这只是个实验功能）\n\t */\n\tscrollTo(listId: number, timeInSecond: number = 0.5, offset: number = 0, overStress: boolean = false) {\n\t\tlet t = this;\n\t\tif (!t.checkInited(false)) return;\n\t\t// t._scrollView.stopAutoScroll();\n\t\tif (timeInSecond === 0)\n\t\t\t//默认0.5\n\t\t\ttimeInSecond = 0.5;\n\t\telse if (timeInSecond < 0) timeInSecond = 0;\n\t\tif (listId < 0) listId = 0;\n\t\telse if (listId >= t._numItems) listId = t._numItems - 1;\n\t\t// 以防设置了numItems之后layout的尺寸还未更新\n\t\tif (!t._virtual && t._layout && t._layout.enabled) t._layout.updateLayout();\n\n\t\tlet pos = t.getItemPos(listId);\n\t\tif (!pos) {\n\t\t\treturn DEV && console.error(\"pos is null\", listId);\n\t\t}\n\t\tlet targetX: number, targetY: number;\n\n\t\tswitch (t._alignCalcType) {\n\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\ttargetX = pos.left;\n\t\t\t\tif (offset !== 0) targetX -= t._thisNodeUt.width * offset;\n\t\t\t\telse targetX -= t._leftGap;\n\t\t\t\tpos = new Vec3(targetX, 0, 0);\n\t\t\t\tbreak;\n\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\ttargetX = pos.right - t._thisNodeUt.width;\n\t\t\t\tif (offset !== 0) targetX += t._thisNodeUt.width * offset;\n\t\t\t\telse targetX += t._rightGap;\n\t\t\t\tpos = new Vec3(targetX + t._contentUt.width, 0, 0);\n\t\t\t\tbreak;\n\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\ttargetY = pos.top;\n\t\t\t\tif (offset !== 0) targetY += t._thisNodeUt.height * offset;\n\t\t\t\telse targetY += t._topGap;\n\t\t\t\tpos = new Vec3(0, -targetY, 0);\n\t\t\t\tbreak;\n\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\ttargetY = pos.bottom + t._thisNodeUt.height;\n\t\t\t\tif (offset !== 0) targetY -= t._thisNodeUt.height * offset;\n\t\t\t\telse targetY -= t._bottomGap;\n\t\t\t\tpos = new Vec3(0, -targetY + t._contentUt.height, 0);\n\t\t\t\tbreak;\n\t\t}\n\t\tlet viewPos: any = t.content.getPosition();\n\t\tviewPos = Math.abs(t._sizeType ? viewPos.y : viewPos.x);\n\n\t\tlet comparePos = t._sizeType ? pos.y : pos.x;\n\t\tlet runScroll = Math.abs((t._scrollPos !== 0 ? t._scrollPos : viewPos) - comparePos) > 0.5;\n\t\t// cc.log(runScroll, t._scrollPos, viewPos, comparePos)\n\n\t\t// t._scrollView.stopAutoScroll();\n\t\tif (runScroll) {\n\t\t\tt._scrollView.scrollToOffset(pos, timeInSecond);\n\t\t\tt._scrollToListId = listId;\n\t\t\tt._scrollToEndTime = new Date().getTime() / 1000 + timeInSecond;\n\t\t\t// cc.log(listId, t.content.width, t.content.getPosition(), pos);\n\t\t\tt._scrollToSo = t.scheduleOnce(() => {\n\t\t\t\tif (!t._adheringBarrier) {\n\t\t\t\t\tt.adhering = t._adheringBarrier = false;\n\t\t\t\t}\n\t\t\t\tt._scrollPos = t._scrollToListId = t._scrollToEndTime = t._scrollToSo = 0;\n\t\t\t\t//cc.log('2222222222', t._adheringBarrier)\n\t\t\t\tif (overStress) {\n\t\t\t\t\t// t.scrollToListId = listId;\n\t\t\t\t\tlet item = t.getItemByListId(listId);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\ttween(item).to(0.1, { scale: 1.05 }).to(0.1, { scale: 1 }).start();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, timeInSecond + 0.1);\n\n\t\t\tif (timeInSecond <= 0) {\n\t\t\t\tt._onScrolling();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 计算当前滚动窗最近的Item\n\t */\n\t_calcNearestItem() {\n\t\tlet t: any = this;\n\t\tt.nearestListId = 0;\n\t\tlet data: any, center: number;\n\n\t\tif (t._virtual) t._calcViewPos();\n\n\t\tlet vTop: number, vRight: number, vBottom: number, vLeft: number;\n\t\tvTop = t.viewTop;\n\t\tvRight = t.viewRight;\n\t\tvBottom = t.viewBottom;\n\t\tvLeft = t.viewLeft;\n\n\t\tlet breakFor: boolean = false;\n\t\tfor (let n = 0; n < t.content.children.length && !breakFor; n += t._colLineNum) {\n\t\t\tdata = t._virtual ? t.displayData[n] : t._calcExistItemPos(n);\n\t\t\tif (data) {\n\t\t\t\tcenter = t._sizeType ? (data.top + data.bottom) / 2 : (center = (data.left + data.right) / 2);\n\t\t\t\tswitch (t._alignCalcType) {\n\t\t\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\t\t\tif (data.right >= vLeft) {\n\t\t\t\t\t\t\tt.nearestListId = data.id;\n\t\t\t\t\t\t\tif (vLeft > center) t.nearestListId += t._colLineNum;\n\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\t\t\tif (data.left <= vRight) {\n\t\t\t\t\t\t\tt.nearestListId = data.id;\n\t\t\t\t\t\t\tif (vRight < center) t.nearestListId += t._colLineNum;\n\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\t\t\tif (data.bottom <= vTop) {\n\t\t\t\t\t\t\tt.nearestListId = data.id;\n\t\t\t\t\t\t\tif (vTop < center) t.nearestListId += t._colLineNum;\n\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\t\t\tif (data.top >= vBottom) {\n\t\t\t\t\t\t\tt.nearestListId = data.id;\n\t\t\t\t\t\t\tif (vBottom > center) t.nearestListId += t._colLineNum;\n\t\t\t\t\t\t\tbreakFor = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//判断最后一个Item。。。（哎，这些判断真心恶心，判断了前面的还要判断最后一个。。。一开始呢，就只有一个布局（单列布局），那时候代码才三百行，后来就想着完善啊，艹..这坑真深，现在这行数都一千五了= =||）\n\t\tdata = t._virtual ? t.displayData[t.displayItemNum - 1] : t._calcExistItemPos(t._numItems - 1);\n\t\tif (data && data.id == t._numItems - 1) {\n\t\t\tcenter = t._sizeType ? (data.top + data.bottom) / 2 : (center = (data.left + data.right) / 2);\n\t\t\tswitch (t._alignCalcType) {\n\t\t\t\tcase 1: //单行HORIZONTAL（LEFT_TO_RIGHT）、网格VERTICAL（LEFT_TO_RIGHT）\n\t\t\t\t\tif (vRight > center) t.nearestListId = data.id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2: //单行HORIZONTAL（RIGHT_TO_LEFT）、网格VERTICAL（RIGHT_TO_LEFT）\n\t\t\t\t\tif (vLeft < center) t.nearestListId = data.id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3: //单列VERTICAL（TOP_TO_BOTTOM）、网格HORIZONTAL（TOP_TO_BOTTOM）\n\t\t\t\t\tif (vBottom < center) t.nearestListId = data.id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4: //单列VERTICAL（BOTTOM_TO_TOP）、网格HORIZONTAL（BOTTOM_TO_TOP）\n\t\t\t\t\tif (vTop > center) t.nearestListId = data.id;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// cc.log('t.nearestListId =', t.nearestListId);\n\t}\n\n\t//上一页\n\tprePage(timeInSecond: number = 0.5) {\n\t\t// cc.log('👈');\n\t\tif (!this.checkInited()) return;\n\t\tthis.skipPage(this.curPageNum - 1, timeInSecond);\n\t}\n\n\t//下一页\n\tnextPage(timeInSecond: number = 0.5) {\n\t\t// cc.log('👉');\n\t\tif (!this.checkInited()) return;\n\t\tthis.skipPage(this.curPageNum + 1, timeInSecond);\n\t}\n\n\t//跳转到第几页\n\tskipPage(pageNum: number, timeInSecond: number) {\n\t\tlet t: any = this;\n\t\tif (!t.checkInited()) return;\n\t\tif (t._slideMode != SlideType.PAGE) return console.error(\"This function is not allowed to be called, Must SlideMode = PAGE!\");\n\t\tif (pageNum < 0 || pageNum >= t._numItems) return;\n\t\tif (t.curPageNum == pageNum) return;\n\t\t// cc.log(pageNum);\n\t\tt.curPageNum = pageNum;\n\t\tif (t.pageChangeEvent) {\n\t\t\tEventHandler.emitEvents([t.pageChangeEvent], pageNum);\n\t\t}\n\t\tt.scrollTo(pageNum, timeInSecond);\n\t}\n\n\t//计算 CustomSize（这个函数还是保留吧，某些罕见的情况的确还是需要手动计算customSize的）\n\tcalcCustomSize(numItems: number) {\n\t\tlet t: any = this;\n\t\tif (!t.checkInited()) return;\n\t\tif (!t._itemTmp) return console.error(\"Unset template item!\");\n\t\tif (!t.renderEvent) return console.error(\"Unset Render-Event!\");\n\t\tt._customSize = {};\n\t\tlet temp: any = instantiate(t._itemTmp);\n\t\tlet ut: UITransform = temp.getComponent(UITransform);\n\t\tt.content.addChild(temp);\n\t\tfor (let n: number = 0; n < numItems; n++) {\n\t\t\tEventHandler.emitEvents([t.renderEvent], temp, n);\n\t\t\tif (ut.height != t._itemSize.height || ut.width != t._itemSize.width) {\n\t\t\t\tt._customSize[n] = t._sizeType ? ut.height : ut.width;\n\t\t\t}\n\t\t}\n\t\tif (!Object.keys(t._customSize).length) t._customSize = null;\n\t\ttemp.removeFromParent();\n\t\tif (temp.destroy) temp.destroy();\n\t\treturn t._customSize;\n\t}\n}\n"]}